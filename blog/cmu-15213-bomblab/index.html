<!DOCTYPE html><html lang="zh-CN"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>CMU-15213-BombLab | 我的博客</title></head> <body class="min-h-screen bg-gray-50 text-gray-900"> <header class="border-b border-gray-200 bg-white shadow-sm"> <div class="max-w-3xl mx-auto px-4 py-4"> <a href="/" class="text-blue-500 hover:underline">← 返回首页</a> </div> </header> <main class="max-w-3xl mx-auto px-4 py-8"> <article class="markdown-body"> <h1 class="text-3xl font-bold mb-2">CMU-15213-BombLab</h1> <div class="text-sm text-gray-500 mb-6"> <time datetime="Thu Aug 14 2025 04:29:00 GMT+0800 (China Standard Time)">2025/8/14</time> </div> <div class="prose prose-lg max-w-none">  <article> <h1 id="cmu-15213-bomblab">CMU-15213-BombLab</h1>
<h2 id="bomblab">BombLab</h2>
<p>要求通过反汇编与debuger，借助主函数源文件实现对6个密码的findout。</p>
<h2 id="记录">记录</h2>
<h3 id="环境与工具">环境与工具</h3>
<p>objdump： 反汇编工具
cgdb： debuger工具 gdb+vim
ubuntu 22.04</p>
<h3 id="bomb-解密">bomb 解密</h3>
<h4 id="prepare-stage">prepare stage</h4>
<p>生成 bomb .t .s 符号表与反汇编</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">objdump</span><span style="color:#79B8FF"> -s</span><span style="color:#9ECBFF"> bomb</span><span style="color:#F97583"> ></span><span style="color:#9ECBFF"> bomb.s</span></span>
<span class="line"><span style="color:#B392F0">objdump</span><span style="color:#79B8FF"> -t</span><span style="color:#9ECBFF"> bomb</span><span style="color:#F97583"> ></span><span style="color:#9ECBFF"> bomb.t</span></span></code></pre>
<p>.t 搜符号表 bomb可以发现 explode_bomb，cgdb调试，并<code>b explode_bomb</code>设置断点，避免误bomb。。。随后打断点到<code>input=read_line()</code>中。</p>
<p>详细注释在.s 反汇编中。</p>
<h4 id="phase_1-stage">phase_1 stage</h4>
<p>首先给phase_1打断点，然后单步调试，通过<code>dump of assmebler code</code>的内容直接可以看到一个地址<code>0x402400</code>，根据底下的strings_not_equal猜测与字符串有关，通过<code>x/s 地址</code>查看字符串格式的内容，可见</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0"> 1│</span><span style="color:#9ECBFF"> Dump</span><span style="color:#9ECBFF"> of</span><span style="color:#9ECBFF"> assembler</span><span style="color:#9ECBFF"> code</span><span style="color:#9ECBFF"> for</span><span style="color:#9ECBFF"> function</span><span style="color:#9ECBFF"> phase_1:</span></span>
<span class="line"><span style="color:#B392F0"> 2│</span><span style="color:#79B8FF">    0x0000000000400ee0</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+</span><span style="color:#F97583">0></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">     sub</span><span style="color:#E1E4E8">    $0x8</span><span style="color:#9ECBFF">,%rsp</span></span>
<span class="line"><span style="color:#B392F0"> 3├──</span><span style="color:#E1E4E8">> </span><span style="color:#79B8FF">0x0000000000400ee4</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+</span><span style="color:#F97583">4></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">     mov</span><span style="color:#E1E4E8">    $0x402400</span><span style="color:#9ECBFF">,%esi</span></span>
<span class="line"><span style="color:#B392F0"> 4│</span><span style="color:#79B8FF">    0x0000000000400ee9</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+</span><span style="color:#F97583">9></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">     call</span><span style="color:#79B8FF">   0x401338</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">strings_not_equa</span><span style="color:#E1E4E8">l</span><span style="color:#F97583">></span></span>
<span class="line"><span style="color:#B392F0"> 5│</span><span style="color:#79B8FF">    0x0000000000400eee</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+1</span><span style="color:#F97583">4></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    test</span><span style="color:#9ECBFF">   %eax,%eax</span></span>
<span class="line"><span style="color:#B392F0"> 6│</span><span style="color:#79B8FF">    0x0000000000400ef0</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+1</span><span style="color:#F97583">6></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    je</span><span style="color:#79B8FF">     0x400ef7</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_1+2</span><span style="color:#F97583">3></span></span>
<span class="line"><span style="color:#B392F0"> 7│</span><span style="color:#79B8FF">    0x0000000000400ef2</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+1</span><span style="color:#F97583">8></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    call</span><span style="color:#79B8FF">   0x40143a</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">explode_bom</span><span style="color:#E1E4E8">b</span><span style="color:#F97583">></span></span>
<span class="line"><span style="color:#B392F0"> 8│</span><span style="color:#79B8FF">    0x0000000000400ef7</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+2</span><span style="color:#F97583">3></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    add</span><span style="color:#E1E4E8">    $0x8</span><span style="color:#9ECBFF">,%rsp</span></span>
<span class="line"><span style="color:#B392F0"> 9│</span><span style="color:#79B8FF">    0x0000000000400efb</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+2</span><span style="color:#F97583">7></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    ret</span></span>
<span class="line"><span style="color:#B392F0">10│</span><span style="color:#9ECBFF"> End</span><span style="color:#9ECBFF"> of</span><span style="color:#9ECBFF"> assembler</span><span style="color:#9ECBFF"> dump.</span></span>
<span class="line"><span style="color:#E1E4E8">(</span><span style="color:#B392F0">gdb</span><span style="color:#E1E4E8">) </span><span style="color:#B392F0">x/s</span><span style="color:#79B8FF"> 0x402400</span><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#B392F0">0x402400:</span><span style="color:#9ECBFF">       "Border relations with Canada have never been better."</span></span></code></pre>
<p>初步可猜测其是第一步的答案</p>
<blockquote>
<p><code>sub $0x8 %rsp</code> 这样对栈顶减去一个直接值得情况，通常可认为这是开辟了一个局部变量，在传参过程中使用第一个寄存器大概率表示第一个参数已经被使用了，根据源代码可以猜测，第一个参数大概是phase_1的传参</p>
</blockquote>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">Dump</span><span style="color:#9ECBFF"> of</span><span style="color:#9ECBFF"> assembler</span><span style="color:#9ECBFF"> code</span><span style="color:#9ECBFF"> for</span><span style="color:#9ECBFF"> function</span><span style="color:#9ECBFF"> strings_not_equal:</span></span>
<span class="line"><span style="color:#B392F0"> 2│</span><span style="color:#79B8FF">    0x0000000000401338</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+</span><span style="color:#F97583">0></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">     push</span><span style="color:#9ECBFF">   %r12</span></span>
<span class="line"><span style="color:#B392F0"> 3│</span><span style="color:#79B8FF">    0x000000000040133a</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">     push</span><span style="color:#9ECBFF">   %rbp</span></span>
<span class="line"><span style="color:#B392F0"> 4│</span><span style="color:#79B8FF">    0x000000000040133b</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+</span><span style="color:#F97583">3></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">     push</span><span style="color:#9ECBFF">   %rbx</span></span>
<span class="line"><span style="color:#B392F0"> 5│</span><span style="color:#79B8FF">    0x000000000040133c</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+</span><span style="color:#F97583">4></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">     mov</span><span style="color:#9ECBFF">    %rdi,%rbx</span></span>
<span class="line"><span style="color:#B392F0"> 6│</span><span style="color:#79B8FF">    0x000000000040133f</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+</span><span style="color:#F97583">7></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">     mov</span><span style="color:#9ECBFF">    %rsi,%rbp</span></span>
<span class="line"><span style="color:#B392F0"> 7├──</span><span style="color:#E1E4E8">> </span><span style="color:#79B8FF">0x0000000000401342</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+1</span><span style="color:#F97583">0></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    call</span><span style="color:#79B8FF">   0x40131b</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">string_lengt</span><span style="color:#E1E4E8">h</span><span style="color:#F97583">></span></span>
<span class="line"><span style="color:#B392F0"> 8│</span><span style="color:#79B8FF">    0x0000000000401347</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+1</span><span style="color:#F97583">5></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    mov</span><span style="color:#9ECBFF">    %eax,%r12d</span></span></code></pre>
<blockquote>
<p>这里使用到了<code>rbx</code>基址寄存器，虽然该寄存器有这个名字，但是其调用者使用原则使其可以稳定的长期记录数据（不会被随意更改）</p>
</blockquote>
<p>很显然，这里是在获取我们输入的参数的长度，并将数据保存到r12d中。</p>
<p>随后的一个结构中</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">14│</span><span style="color:#79B8FF"> 	 0x000000000040135c</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+3</span><span style="color:#F97583">6></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    movzbl</span><span style="color:#E1E4E8"> (%rbx),%eax</span></span>
<span class="line"><span style="color:#B392F0">15│</span><span style="color:#79B8FF">    0x000000000040135f</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+3</span><span style="color:#F97583">9></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    test</span><span style="color:#9ECBFF">   %al,%al</span></span>
<span class="line"><span style="color:#B392F0">16│</span><span style="color:#79B8FF">    0x0000000000401361</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+4</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    je</span><span style="color:#79B8FF">     0x401388</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">strings_not_equal+8</span><span style="color:#F97583">0></span></span>
<span class="line"><span style="color:#B392F0">17│</span><span style="color:#79B8FF">    0x0000000000401363</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+4</span><span style="color:#F97583">3></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    cmp</span><span style="color:#79B8FF">    0x0</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rbp</span><span style="color:#E1E4E8">)</span><span style="color:#9ECBFF">,%al</span></span>
<span class="line"><span style="color:#B392F0">18│</span><span style="color:#79B8FF">    0x0000000000401366</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+4</span><span style="color:#F97583">6></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    je</span><span style="color:#79B8FF">     0x401372</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">strings_not_equal+5</span><span style="color:#F97583">8></span></span>
<span class="line"><span style="color:#B392F0">19│</span><span style="color:#79B8FF">    0x0000000000401368</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+4</span><span style="color:#F97583">8></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    jmp</span><span style="color:#79B8FF">    0x40138f</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">strings_not_equal+8</span><span style="color:#F97583">7></span></span></code></pre>
<p>这里将rbx指向的字符（8位，一个字节）传入到ax中扩展为32位，并判断是否为空，随后对比一个字节大小的bp与al,即写死的字符与最初传参的第一个字符</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">20├──</span><span style="color:#E1E4E8">> </span><span style="color:#79B8FF">0x000000000040136a</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+5</span><span style="color:#F97583">0></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    cmp</span><span style="color:#79B8FF">    0x0</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rbp</span><span style="color:#E1E4E8">)</span><span style="color:#9ECBFF">,%al</span></span>
<span class="line"><span style="color:#B392F0">21│</span><span style="color:#79B8FF">    0x000000000040136d</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+5</span><span style="color:#F97583">3></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    nopl</span><span style="color:#E1E4E8">   (%rax)</span></span>
<span class="line"><span style="color:#B392F0">22│</span><span style="color:#79B8FF">    0x0000000000401370</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+5</span><span style="color:#F97583">6></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    jne</span><span style="color:#79B8FF">    0x401396</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">strings_not_equal+9</span><span style="color:#F97583">4></span></span>
<span class="line"><span style="color:#B392F0">23│</span><span style="color:#79B8FF">    0x0000000000401372</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+5</span><span style="color:#F97583">8></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    add</span><span style="color:#E1E4E8">    $0x1</span><span style="color:#9ECBFF">,%rbx</span></span>
<span class="line"><span style="color:#B392F0">24│</span><span style="color:#79B8FF">    0x0000000000401376</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+6</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    add</span><span style="color:#E1E4E8">    $0x1</span><span style="color:#9ECBFF">,%rbp</span></span>
<span class="line"><span style="color:#B392F0">25│</span><span style="color:#79B8FF">    0x000000000040137a</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+6</span><span style="color:#F97583">6></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    movzbl</span><span style="color:#E1E4E8"> (%rbx),%eax</span></span>
<span class="line"><span style="color:#B392F0">26│</span><span style="color:#79B8FF">    0x000000000040137d</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+6</span><span style="color:#F97583">9></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    test</span><span style="color:#9ECBFF">   %al,%al</span></span>
<span class="line"><span style="color:#B392F0">27│</span><span style="color:#79B8FF">    0x000000000040137f</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+7</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    jne</span><span style="color:#79B8FF">    0x40136a</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">strings_not_equal+5</span><span style="color:#F97583">0></span></span></code></pre>
<p>这是一个循环体，其中<code>26</code>行为判断退出的条件，即传入的<code>rbx</code>字符串在循环迭代中非空。</p>
<p>综上两个接口，可以看出这是一个<code>while...do</code>，或者说<code>for</code>循环的结构体，用于判断两个字符串是否相同，至此可以判断phase_1的答案是</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">Border</span><span style="color:#9ECBFF"> relations</span><span style="color:#9ECBFF"> with</span><span style="color:#9ECBFF"> Canada</span><span style="color:#9ECBFF"> have</span><span style="color:#9ECBFF"> never</span><span style="color:#9ECBFF"> been</span><span style="color:#9ECBFF"> better.</span><span style="color:#E1E4E8"> </span></span></code></pre>
<p>完成对剩余代码的分析</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">b</span><span style="color:#79B8FF"> 0x401381</span></span>
<span class="line"><span style="color:#B392F0">c</span></span></code></pre>
<p>跳过循环</p>
<p>可以看到一堆jmp以及mov .. to %edx</p>
<p>这里直接给出定义，这里是不同分支的归一并给标志参数赋值！</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">28│</span><span style="color:#79B8FF">    0x0000000000401381</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+7</span><span style="color:#F97583">3></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    mov</span><span style="color:#E1E4E8">    $0x0</span><span style="color:#9ECBFF">,%edx</span></span>
<span class="line"><span style="color:#B392F0">29│</span><span style="color:#79B8FF">    0x0000000000401386</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+7</span><span style="color:#F97583">8></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    jmp</span><span style="color:#79B8FF">    0x40139b</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">strings_not_equal+9</span><span style="color:#F97583">9></span></span>
<span class="line"><span style="color:#B392F0">30│</span><span style="color:#79B8FF">    0x0000000000401388</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+8</span><span style="color:#F97583">0></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    mov</span><span style="color:#E1E4E8">    $0x0</span><span style="color:#9ECBFF">,%edx</span></span>
<span class="line"><span style="color:#B392F0">31│</span><span style="color:#79B8FF">    0x000000000040138d</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+8</span><span style="color:#F97583">5></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    jmp</span><span style="color:#79B8FF">    0x40139b</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">strings_not_equal+9</span><span style="color:#F97583">9></span></span>
<span class="line"><span style="color:#B392F0">32│</span><span style="color:#79B8FF">    0x000000000040138f</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+8</span><span style="color:#F97583">7></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    mov</span><span style="color:#E1E4E8">    $0x1</span><span style="color:#9ECBFF">,%edx</span></span>
<span class="line"><span style="color:#B392F0">33│</span><span style="color:#79B8FF">    0x0000000000401394</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+9</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    jmp</span><span style="color:#79B8FF">    0x40139b</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">strings_not_equal+9</span><span style="color:#F97583">9></span></span>
<span class="line"><span style="color:#B392F0">34│</span><span style="color:#79B8FF">    0x0000000000401396</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+9</span><span style="color:#F97583">4></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    mov</span><span style="color:#E1E4E8">    $0x1</span><span style="color:#9ECBFF">,%edx</span></span>
<span class="line"><span style="color:#B392F0">35├──</span><span style="color:#E1E4E8">> </span><span style="color:#79B8FF">0x000000000040139b</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+9</span><span style="color:#F97583">9></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    mov</span><span style="color:#9ECBFF">    %edx,%eax</span></span>
<span class="line"><span style="color:#B392F0">36│</span><span style="color:#79B8FF">    0x000000000040139d</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+10</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   pop</span><span style="color:#9ECBFF">    %rbx</span></span>
<span class="line"><span style="color:#B392F0">37│</span><span style="color:#79B8FF">    0x000000000040139e</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+10</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   pop</span><span style="color:#9ECBFF">    %rbp</span></span>
<span class="line"><span style="color:#B392F0">38│</span><span style="color:#79B8FF">    0x000000000040139f</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+10</span><span style="color:#F97583">3></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   pop</span><span style="color:#9ECBFF">    %r12</span></span>
<span class="line"><span style="color:#B392F0">39│</span><span style="color:#79B8FF">    0x00000000004013a1</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+10</span><span style="color:#F97583">5></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   ret</span><span style="color:#E1E4E8">    </span></span></code></pre>
<p>最后复原寄存器的值，并将标志参数rdx返回到ax中（标准返回寄存器）</p>
<h4 id="phase_2-stage">phase_2 stage</h4>
<p>phase2中存在一个复杂的开栈记录数据的过程</p>
<p><img src="https://pica.zhimg.com/v2-6cf9a6407eee1098534a64a65f162fe0_1440w.jpg" alt="img" loading="lazy" decoding="async" class="mx-auto rounded-lg shadow" srcset="https://pica.zhimg.com/v2-6cf9a6407eee1098534a64a65f162fe0_1440w.jpg?w=640 640w, https://pica.zhimg.com/v2-6cf9a6407eee1098534a64a65f162fe0_1440w.jpg?w=1280 1280w" sizes="(max-width: 768px) 100vw, 768px"></p>
<p>phase2中由于超出了6个参数（包括格式），因此出现了栈上传参的方法，常见传参六个寄存器为</p>

































<table><thead><tr><th>参数号</th><th>对应寄存器</th></tr></thead><tbody><tr><td>第 1 个</td><td>RDI</td></tr><tr><td>第 2 个</td><td>RSI</td></tr><tr><td>第 3 个</td><td>RDX</td></tr><tr><td>第 4 个</td><td>RCX</td></tr><tr><td>第 5 个</td><td>R8</td></tr><tr><td>第 6 个</td><td>R9</td></tr></tbody></table>
<p>注意上图，这里传入的参数全部保存在phase_2开辟的空间当中，而read_six_number开辟的空间，完全是为了保存局部变量，也就是读入的参数。</p>
<blockquote>
<p>在调用read_six_number函数前，程序保存了rsi参数的值，这是第二个参数，为什么不是第一个参数rdi呢？这是因为rdi的设置发生在更早的指令中。例如传入phase_2的参数</p>
</blockquote>
<p>这里就不细说read_six_numers这个函数了,其中涉及的lea命令，jg命令可以在command ref位置查询。</p>
<p>随后可见又出现了一个循环体</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">11│</span><span style="color:#79B8FF">    0x0000000000400f17</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+2</span><span style="color:#F97583">7></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    mov</span><span style="color:#79B8FF">    -0x4(%rbx</span><span style="color:#E1E4E8">),%eax</span></span>
<span class="line"><span style="color:#B392F0">12│</span><span style="color:#79B8FF">    0x0000000000400f1a</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+3</span><span style="color:#F97583">0></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    add</span><span style="color:#9ECBFF">    %eax,%eax</span></span>
<span class="line"><span style="color:#B392F0">13│</span><span style="color:#79B8FF">    0x0000000000400f1c</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+3</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    cmp</span><span style="color:#9ECBFF">    %eax,</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rbx</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#B392F0">14│</span><span style="color:#79B8FF">    0x0000000000400f1e</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+3</span><span style="color:#F97583">4></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    je</span><span style="color:#79B8FF">     0x400f25</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_2+4</span><span style="color:#F97583">1></span></span>
<span class="line"><span style="color:#B392F0">15│</span><span style="color:#79B8FF">    0x0000000000400f20</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+3</span><span style="color:#F97583">6></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    call</span><span style="color:#79B8FF">   0x40143a</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">explode_bom</span><span style="color:#E1E4E8">b</span><span style="color:#F97583">></span></span>
<span class="line"><span style="color:#B392F0">16│</span><span style="color:#79B8FF">    0x0000000000400f25</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+4</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    add</span><span style="color:#E1E4E8">    $0x4</span><span style="color:#9ECBFF">,%rbx</span></span>
<span class="line"><span style="color:#B392F0">17│</span><span style="color:#79B8FF">    0x0000000000400f29</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+4</span><span style="color:#F97583">5></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    cmp</span><span style="color:#9ECBFF">    %rbp,%rbx</span></span>
<span class="line"><span style="color:#B392F0">18│</span><span style="color:#79B8FF">    0x0000000000400f2c</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+4</span><span style="color:#F97583">8></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    jne</span><span style="color:#79B8FF">    0x400f17</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_2+2</span><span style="color:#F97583">7></span></span>
<span class="line"><span style="color:#B392F0">19│</span><span style="color:#79B8FF">    0x0000000000400f2e</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+5</span><span style="color:#F97583">0></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    jmp</span><span style="color:#79B8FF">    0x400f3c</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_2+6</span><span style="color:#F97583">4></span></span>
<span class="line"><span style="color:#B392F0">20│</span><span style="color:#79B8FF">    0x0000000000400f30</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+5</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    lea</span><span style="color:#79B8FF">    0x4</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rsp</span><span style="color:#E1E4E8">)</span><span style="color:#9ECBFF">,%rbx</span></span>
<span class="line"><span style="color:#B392F0">21│</span><span style="color:#79B8FF">    0x0000000000400f35</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+5</span><span style="color:#F97583">7></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    lea</span><span style="color:#79B8FF">    0x18</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rsp</span><span style="color:#E1E4E8">)</span><span style="color:#9ECBFF">,%rbp</span></span>
<span class="line"><span style="color:#B392F0">22│</span><span style="color:#79B8FF">    0x0000000000400f3a</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+6</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    jmp</span><span style="color:#79B8FF">    0x400f17</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_2+2</span><span style="color:#F97583">7></span></span></code></pre>
<p>前面几个与循环体无关的我省略了，基本就是比较栈顶与1，然后进入+52的循环段。这里初始化了两个指针bx，bp,分别是栈顶的前一位和最后一位。</p>
<p>然后然后可以看看哪里是判断结束的,可见+50处有一个jump到+60的，认为这里就是跳出循环的，可见，需要bp，bx相等。</p>
<p>这也就是双指针的逻辑了，然后+30处很容易想到这是一个倍增的数组。于是答案就是</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">1</span><span style="color:#79B8FF"> 2</span><span style="color:#79B8FF"> 4</span><span style="color:#79B8FF"> 8</span><span style="color:#79B8FF"> 16</span><span style="color:#79B8FF"> 32</span></span></code></pre>
<p>因为不是第一个phase了，对汇编也熟悉一些了，这里略过剩下的汇编代码</p>
<h3 id="phase_3-stage">phase_3 stage</h3>
<p>这里直接字符串查看看见的两个地址0x4025cf,0x400bf0。可见前一个是输入两个整数的规范字符串,后者是-1。随后读入了两个字符</p>
<blockquote>
<p><a href="mailto:__isoc99_sscanf@plt">__isoc99_sscanf@plt</a> 是 反汇编工具（如 objdump 或 GDB）添加的**“符号注释” **。</p>
<p>__isoc99_sscanf
这是 sscanf 函数的实际符号名（symbol name）</p>
<p>为什么不是 sscanf？因为：
编译器为了兼容 C99 标准，使用 __isoc99_sscanf作为内部符号它是标准库函数 int sscanf(const char *str, const char *format, …); 的实现</p>
</blockquote>
<p>随后+32，jg该命令告诉我们，此时输入的字符数量必须大于1</p>
<p>这里我们先填入</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="plaintext"><code><span class="line"><span>1 2</span></span></code></pre>
<p>顺利逃过了第一个explode，继续运行，又遇到了一个分支，如果我们填入的第一个参数比7大，则会跳转到+106，是一个explode，因此第一个参数必须比7小，这里也顺利逃过。</p>
<p>随后看到了一个奇怪的jump</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">14├──</span><span style="color:#E1E4E8">> </span><span style="color:#79B8FF">0x0000000000400f75</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+5</span><span style="color:#F97583">0></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    jmp</span><span style="color:#79B8FF">    *</span><span style="color:#9ECBFF">0x402470</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">,%rax,8</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p>这是一个switch-case 跳转表（jump table）。</p>
<p>语法结构（AT&#x26;T 格式）：</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">基地址</span><span style="color:#9ECBFF"> +</span><span style="color:#9ECBFF"> 索引</span><span style="color:#79B8FF"> *</span><span style="color:#9ECBFF"> 尺寸</span><span style="color:#9ECBFF"> +</span><span style="color:#9ECBFF"> 偏移</span></span>
<span class="line"><span style="color:#B392F0">→</span><span style="color:#9ECBFF"> disp</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">base,</span><span style="color:#9ECBFF"> index,</span><span style="color:#9ECBFF"> scale</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#6A737D"># 0x402470(,%rax,8) = 0x402470 + %rax * 8</span></span></code></pre>
<p>查询这个跳转表</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#E1E4E8">(</span><span style="color:#B392F0">gdb</span><span style="color:#E1E4E8">)  </span><span style="color:#B392F0">x/8gx</span><span style="color:#79B8FF"> 0x402470</span></span>
<span class="line"><span style="color:#B392F0">0x402470:</span><span style="color:#79B8FF">       0x0000000000400f7c</span><span style="color:#79B8FF">      0x0000000000400fb9</span></span>
<span class="line"><span style="color:#B392F0">0x402480:</span><span style="color:#79B8FF">       0x0000000000400f83</span><span style="color:#79B8FF">      0x0000000000400f8a</span></span>
<span class="line"><span style="color:#B392F0">0x402490:</span><span style="color:#79B8FF">       0x0000000000400f91</span><span style="color:#79B8FF">      0x0000000000400f98</span></span>
<span class="line"><span style="color:#B392F0">0x4024a0:</span><span style="color:#79B8FF">       0x0000000000400f9f</span><span style="color:#79B8FF">      0x0000000000400fa6</span></span></code></pre>
<p>可见我们会跳转到<code>0x0000000000400fb9</code></p>
<p>随后直接跳转到</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">25│</span><span style="color:#79B8FF">    0x0000000000400f9f</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+9</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    mov</span><span style="color:#E1E4E8">    $0x2aa</span><span style="color:#9ECBFF">,%eax</span></span>
<span class="line"><span style="color:#B392F0">26│</span><span style="color:#79B8FF">    0x0000000000400fa4</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+9</span><span style="color:#F97583">7></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    jmp</span><span style="color:#79B8FF">    0x400fbe</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_3+12</span><span style="color:#F97583">3></span></span>
<span class="line"><span style="color:#B392F0">27│</span><span style="color:#79B8FF">    0x0000000000400fa6</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+9</span><span style="color:#F97583">9></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    mov</span><span style="color:#E1E4E8">    $0x147</span><span style="color:#9ECBFF">,%eax</span></span>
<span class="line"><span style="color:#B392F0">28│</span><span style="color:#79B8FF">    0x0000000000400fab</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+10</span><span style="color:#F97583">4></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   jmp</span><span style="color:#79B8FF">    0x400fbe</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_3+12</span><span style="color:#F97583">3></span></span>
<span class="line"><span style="color:#B392F0">29│</span><span style="color:#79B8FF">    0x0000000000400fad</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+10</span><span style="color:#F97583">6></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   call</span><span style="color:#79B8FF">   0x40143a</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">explode_bom</span><span style="color:#E1E4E8">b</span><span style="color:#F97583">></span></span>
<span class="line"><span style="color:#B392F0">30│</span><span style="color:#79B8FF">    0x0000000000400fb2</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+11</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#E1E4E8">    $0x0</span><span style="color:#9ECBFF">,%eax</span></span>
<span class="line"><span style="color:#B392F0">31│</span><span style="color:#79B8FF">    0x0000000000400fb7</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+11</span><span style="color:#F97583">6></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   jmp</span><span style="color:#79B8FF">    0x400fbe</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_3+12</span><span style="color:#F97583">3></span></span>
<span class="line"><span style="color:#B392F0">32├──</span><span style="color:#E1E4E8">> </span><span style="color:#79B8FF">0x0000000000400fb9</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+11</span><span style="color:#F97583">8></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#E1E4E8">    $0x137</span><span style="color:#9ECBFF">,%eax</span></span>
<span class="line"><span style="color:#B392F0">33│</span><span style="color:#79B8FF">    0x0000000000400fbe</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+12</span><span style="color:#F97583">3></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   cmp</span><span style="color:#79B8FF">    0xc</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rsp</span><span style="color:#E1E4E8">)</span><span style="color:#9ECBFF">,%eax</span></span>
<span class="line"><span style="color:#B392F0">34│</span><span style="color:#79B8FF">    0x0000000000400fc2</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+12</span><span style="color:#F97583">7></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   je</span><span style="color:#79B8FF">     0x400fc9</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_3+13</span><span style="color:#F97583">4></span></span>
<span class="line"><span style="color:#B392F0">35│</span><span style="color:#79B8FF">    0x0000000000400fc4</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+12</span><span style="color:#F97583">9></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   call</span><span style="color:#79B8FF">   0x40143a</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">explode_bom</span><span style="color:#E1E4E8">b</span><span style="color:#F97583">></span></span>
<span class="line"><span style="color:#B392F0">36│</span><span style="color:#79B8FF">    0x0000000000400fc9</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+13</span><span style="color:#F97583">4></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   add</span><span style="color:#E1E4E8">    $0x18</span><span style="color:#9ECBFF">,%rsp</span></span>
<span class="line"><span style="color:#B392F0">37│</span><span style="color:#79B8FF">    0x0000000000400fcd</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+13</span><span style="color:#F97583">8></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   ret</span></span></code></pre>
<p>然后比较0x137(d311)与第二个值得大小，相等则跳到 + 134，似乎直接返回了</p>
<p>于是尝试</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">1</span><span style="color:#79B8FF"> 311</span></span></code></pre>
<h3 id="phase_4-stage">phase_4 stage</h3>
<p>照例查看一下.s文件，先尝试输入两个数字</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">1</span><span style="color:#79B8FF"> 2</span><span style="color:#E1E4E8"> </span></span></code></pre>
<p>查看0x4025cf确认是输入两个数字。确认是的。随后jbe判断第一个数小于等于14</p>
<blockquote>
<p><code>jbe</code>:Jump if Below or Equal &#x3C;=</p>
</blockquote>
<p>随后调用了func4，调用参数如下</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">esi</span><span style="color:#9ECBFF"> =</span><span style="color:#79B8FF"> 0</span></span>
<span class="line"><span style="color:#B392F0">edx</span><span style="color:#9ECBFF"> =</span><span style="color:#79B8FF"> 14</span></span>
<span class="line"><span style="color:#B392F0">edi</span><span style="color:#9ECBFF"> =</span><span style="color:#9ECBFF"> 第一个参数（1）</span></span></code></pre>
<p>首先用edx得值减了一下esi，保存值在eax、ecx。然后ecx逻辑右移了16+15=31位，保留了最高位的值为1或0，随后又加上eax，随后对eax进行算数右移/2。</p>
<p><code>ecx = rax + rsi * 1 = 7</code>
然后比较edi与ecx即edi是否小于等于7</p>
<p>如果小于则rcx减一赋值给rdx,递归调用func4</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">esi</span><span style="color:#9ECBFF"> =</span><span style="color:#79B8FF"> 0</span></span>
<span class="line"><span style="color:#B392F0">edx</span><span style="color:#9ECBFF"> =</span><span style="color:#79B8FF"> 6</span></span>
<span class="line"><span style="color:#B392F0">edi</span><span style="color:#9ECBFF"> =</span><span style="color:#9ECBFF"> 第一个参数</span></span></code></pre>
<p>最后一次递归的处理返回值是</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">16│</span><span style="color:#79B8FF">    0x0000000000400ff2</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+3</span><span style="color:#F97583">6></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    mov</span><span style="color:#E1E4E8">    $0x0</span><span style="color:#9ECBFF">,%eax</span></span>
<span class="line"><span style="color:#B392F0">17│</span><span style="color:#79B8FF">    0x0000000000400ff7</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+4</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    cmp</span><span style="color:#9ECBFF">    %edi,%ecx</span></span>
<span class="line"><span style="color:#B392F0">18│</span><span style="color:#79B8FF">    0x0000000000400ff9</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+4</span><span style="color:#F97583">3></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    jge</span><span style="color:#79B8FF">    0x401007</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">func4+5</span><span style="color:#F97583">7></span></span>
<span class="line"><span style="color:#B392F0">19│</span><span style="color:#79B8FF">    0x0000000000400ffb</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+4</span><span style="color:#F97583">5></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    lea</span><span style="color:#79B8FF">    0x1</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rcx</span><span style="color:#E1E4E8">)</span><span style="color:#9ECBFF">,%esi</span></span>
<span class="line"><span style="color:#B392F0">20│</span><span style="color:#79B8FF">    0x0000000000400ffe</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+4</span><span style="color:#F97583">8></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    call</span><span style="color:#79B8FF">   0x400fce</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">func</span><span style="color:#F97583">4></span></span>
<span class="line"><span style="color:#B392F0">21│</span><span style="color:#79B8FF">    0x0000000000401003</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+5</span><span style="color:#F97583">3></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    lea</span><span style="color:#79B8FF">    0x1</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rax,%rax,1</span><span style="color:#E1E4E8">)</span><span style="color:#9ECBFF">,%eax</span></span>
<span class="line"><span style="color:#B392F0">22│</span><span style="color:#79B8FF">    0x0000000000401007</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+5</span><span style="color:#F97583">7></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    add</span><span style="color:#E1E4E8">    $0x8</span><span style="color:#9ECBFF">,%rsp</span></span>
<span class="line"><span style="color:#B392F0">23│</span><span style="color:#79B8FF">    0x000000000040100b</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+6</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    ret</span></span></code></pre>
<p>比较di与cx的值（前面保证cx小于等于di），即，这里如果等于则返回0，如果不等于则赋值si，递归，返回一个其他值。</p>
<p>按照目前输入，最终递归结果为</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">esi</span><span style="color:#9ECBFF"> =</span><span style="color:#79B8FF"> 0</span></span>
<span class="line"><span style="color:#B392F0">edx</span><span style="color:#9ECBFF"> =</span><span style="color:#79B8FF"> 2</span></span>
<span class="line"><span style="color:#B392F0">edi</span><span style="color:#9ECBFF"> =</span><span style="color:#79B8FF"> 1</span></span>
<span class="line"><span style="color:#B392F0">eax</span><span style="color:#9ECBFF"> =</span><span style="color:#79B8FF"> 0</span></span></code></pre>
<p>函数停留在+32，继续执行返回0。</p>
<p>退回phase_4</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">17│--</span><span style="color:#E1E4E8">> </span><span style="color:#79B8FF">0x000000000040104d</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+6</span><span style="color:#F97583">5></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    test</span><span style="color:#9ECBFF">   %eax,%eax</span></span>
<span class="line"><span style="color:#B392F0">18│</span><span style="color:#79B8FF">    0x000000000040104f</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+6</span><span style="color:#F97583">7></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    jne</span><span style="color:#79B8FF">    0x401058</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_4+7</span><span style="color:#F97583">6></span></span>
<span class="line"><span style="color:#B392F0">19│</span><span style="color:#79B8FF">    0x0000000000401051</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+6</span><span style="color:#F97583">9></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    cmpl</span><span style="color:#E1E4E8">   $0x0</span><span style="color:#9ECBFF">,0xc</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rsp</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#B392F0">20│</span><span style="color:#79B8FF">    0x0000000000401056</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+7</span><span style="color:#F97583">4></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    je</span><span style="color:#79B8FF">     0x40105d</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_4+8</span><span style="color:#F97583">1></span></span>
<span class="line"><span style="color:#B392F0">21│</span><span style="color:#79B8FF">    0x0000000000401058</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+7</span><span style="color:#F97583">6></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    call</span><span style="color:#79B8FF">   0x40143a</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">explode_bom</span><span style="color:#E1E4E8">b</span><span style="color:#F97583">></span></span>
<span class="line"><span style="color:#B392F0">22│</span><span style="color:#79B8FF">    0x000000000040105d</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+8</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    add</span><span style="color:#E1E4E8">    $0x18</span><span style="color:#9ECBFF">,%rsp</span></span>
<span class="line"><span style="color:#B392F0">23│</span><span style="color:#79B8FF">    0x0000000000401061</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+8</span><span style="color:#F97583">5></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    ret</span><span style="color:#E1E4E8">    </span></span>
<span class="line"></span></code></pre>
<p>可见返回值不能是非0，然后比较第二个参数是否为0。</p>
<p>那么改为</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">1</span><span style="color:#79B8FF"> 0</span></span></code></pre>
<p>即可通过phase_4</p>
<h3 id="phase_5-stage">phase_5 stage</h3>
<p>观察一下phase_5，输入一个长度等于6的字符串</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">abcdef</span></span></code></pre>
<p>先解释一下这一个奇怪的地址</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0"> 5│</span><span style="color:#79B8FF">    0x000000000040106a</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+</span><span style="color:#F97583">8></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">     mov</span><span style="color:#9ECBFF">    %fs:0x28,%rax</span></span></code></pre>
<ol>
<li>%fs是一个 段寄存器（segment register）在 Linux x86-64 中，%fs 通常指向当前线程的 Thread Local Storage（TLS） 区域它用于实现线程局部变量、栈保护等</li>
<li>0x28是一个偏移量（40 字节）%fs:0x28 表示：从 %fs 指向的基地址开始，偏移 0x28 字节处的内存</li>
<li>mov …, %rax将该内存地址中的值读取到 %rax 寄存器中</li>
</ol>
<p>简单查询该处的值，为0x28(d40),但执行到该处发现，寄存器的值与这样查询出的值完全不同， 查看fs的地址，为0，显然有错误在其中。</p>
<p>查询ai，发现该条mov是程序在访问 x86-64 架构中的线程局部存储（TLS），并且这行代码通常是 栈保护机制（Stack Canary） 的一部分。</p>
<p>无论如何，rax的值为</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#E1E4E8">(</span><span style="color:#B392F0">gdb</span><span style="color:#E1E4E8">) </span><span style="color:#B392F0">p/d</span><span style="color:#E1E4E8"> $eax</span></span>
<span class="line"><span style="color:#E1E4E8">$37 = 1120943104</span></span>
<span class="line"><span style="color:#E1E4E8">(</span><span style="color:#B392F0">gdb</span><span style="color:#E1E4E8">) </span><span style="color:#B392F0">x/d</span><span style="color:#E1E4E8"> $eax</span></span>
<span class="line"><span style="color:#B392F0">0x42d03c00:</span><span style="color:#9ECBFF">     Cannot</span><span style="color:#9ECBFF"> access</span><span style="color:#9ECBFF"> memory</span><span style="color:#9ECBFF"> at</span><span style="color:#9ECBFF"> address</span><span style="color:#79B8FF"> 0x42d03c00</span></span>
<span class="line"><span style="color:#E1E4E8">(</span><span style="color:#B392F0">gdb</span><span style="color:#E1E4E8">) </span><span style="color:#B392F0">p/d</span><span style="color:#E1E4E8"> $rax</span></span>
<span class="line"><span style="color:#E1E4E8">$38 = -4452265605897110528</span></span>
<span class="line"><span style="color:#E1E4E8">(</span><span style="color:#B392F0">gdb</span><span style="color:#E1E4E8">) </span><span style="color:#B392F0">x/d</span><span style="color:#E1E4E8"> $rax</span></span>
<span class="line"><span style="color:#B392F0">0xc236600542d03c00:</span><span style="color:#9ECBFF">     Cannot</span><span style="color:#9ECBFF"> access</span><span style="color:#9ECBFF"> memory</span><span style="color:#9ECBFF"> at</span><span style="color:#9ECBFF"> address</span><span style="color:#79B8FF"> 0xc236600542d03c00</span></span></code></pre>
<p>运行<code> 7│    0x0000000000401078 &#x3C;+22>:    xor    %eax,%eax</code>后，发现，eax，rax均变为了0。</p>
<p>随后，发现跳转到一个循环内了</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">13│</span><span style="color:#79B8FF">    0x000000000040108b</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+4</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    movzbl</span><span style="color:#E1E4E8"> (%rbx,%rax,1),%ecx</span></span>
<span class="line"><span style="color:#B392F0">14│</span><span style="color:#79B8FF">    0x000000000040108f</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+4</span><span style="color:#F97583">5></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    mov</span><span style="color:#9ECBFF">    %cl,</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rsp</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#B392F0">15│</span><span style="color:#79B8FF">    0x0000000000401092</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+4</span><span style="color:#F97583">8></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    mov</span><span style="color:#E1E4E8">    (%rsp),%rdx</span></span>
<span class="line"><span style="color:#B392F0">16│</span><span style="color:#79B8FF">    0x0000000000401096</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+5</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    and</span><span style="color:#E1E4E8">    $0xf</span><span style="color:#9ECBFF">,%edx</span></span>
<span class="line"><span style="color:#B392F0">17│</span><span style="color:#79B8FF">    0x0000000000401099</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+5</span><span style="color:#F97583">5></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    movzbl</span><span style="color:#79B8FF"> 0x4024b0</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rdx</span><span style="color:#E1E4E8">)</span><span style="color:#9ECBFF">,%edx</span></span>
<span class="line"><span style="color:#B392F0">18│</span><span style="color:#79B8FF">    0x00000000004010a0</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+6</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    mov</span><span style="color:#9ECBFF">    %dl,0x10</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rsp,%rax,1</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#B392F0">19│</span><span style="color:#79B8FF">    0x00000000004010a4</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+6</span><span style="color:#F97583">6></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    add</span><span style="color:#E1E4E8">    $0x1</span><span style="color:#9ECBFF">,%rax</span></span>
<span class="line"><span style="color:#B392F0">20│</span><span style="color:#79B8FF">    0x00000000004010a8</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+7</span><span style="color:#F97583">0></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    cmp</span><span style="color:#E1E4E8">    $0x6</span><span style="color:#9ECBFF">,%rax</span></span>
<span class="line"><span style="color:#B392F0">21│</span><span style="color:#79B8FF">    0x00000000004010ac</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+7</span><span style="color:#F97583">4></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    jne</span><span style="color:#79B8FF">    0x40108b</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_5+4</span><span style="color:#F97583">1></span></span>
<span class="line"><span style="color:#B392F0">22│</span><span style="color:#79B8FF">    0x00000000004010ae</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+7</span><span style="color:#F97583">6></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    movb</span><span style="color:#E1E4E8">   $0x0</span><span style="color:#9ECBFF">,0x16</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rsp</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#B392F0">23│</span><span style="color:#79B8FF">    0x00000000004010b3</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+8</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    mov</span><span style="color:#E1E4E8">    $0x40245e</span><span style="color:#9ECBFF">,%esi</span></span>
<span class="line"><span style="color:#B392F0">24│</span><span style="color:#79B8FF">    0x00000000004010b8</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+8</span><span style="color:#F97583">6></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    lea</span><span style="color:#79B8FF">    0x10</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rsp</span><span style="color:#E1E4E8">)</span><span style="color:#9ECBFF">,%rdi</span></span>
<span class="line"><span style="color:#B392F0">25│</span><span style="color:#79B8FF">    0x00000000004010bd</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+9</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    call</span><span style="color:#79B8FF">   0x401338</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">strings_not_equa</span><span style="color:#E1E4E8">l</span><span style="color:#F97583">></span></span>
<span class="line"><span style="color:#B392F0">26│</span><span style="color:#79B8FF">    0x00000000004010c2</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+9</span><span style="color:#F97583">6></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    test</span><span style="color:#9ECBFF">   %eax,%eax</span></span>
<span class="line"><span style="color:#B392F0">27│</span><span style="color:#79B8FF">    0x00000000004010c4</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+9</span><span style="color:#F97583">8></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    je</span><span style="color:#79B8FF">     0x4010d9</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_5+11</span><span style="color:#F97583">9></span></span>
<span class="line"><span style="color:#B392F0">28│</span><span style="color:#79B8FF">    0x00000000004010c6</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+10</span><span style="color:#F97583">0></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   call</span><span style="color:#79B8FF">   0x40143a</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">explode_bom</span><span style="color:#E1E4E8">b</span><span style="color:#F97583">></span></span>
<span class="line"><span style="color:#B392F0">29│</span><span style="color:#79B8FF">    0x00000000004010cb</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+10</span><span style="color:#F97583">5></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   nopl</span><span style="color:#79B8FF">   0x0</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rax,%rax,1</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#B392F0">30│</span><span style="color:#79B8FF">    0x00000000004010d0</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+11</span><span style="color:#F97583">0></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   jmp</span><span style="color:#79B8FF">    0x4010d9</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_5+11</span><span style="color:#F97583">9></span></span>
<span class="line"><span style="color:#B392F0">31├──</span><span style="color:#E1E4E8">> </span><span style="color:#79B8FF">0x00000000004010d2</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+11</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#E1E4E8">    $0x0</span><span style="color:#9ECBFF">,%eax</span></span>
<span class="line"><span style="color:#B392F0">32│</span><span style="color:#79B8FF">    0x00000000004010d7</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+11</span><span style="color:#F97583">7></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   jmp</span><span style="color:#79B8FF">    0x40108b</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_5+4</span><span style="color:#F97583">1></span></span></code></pre>
<p>简单执行发现：</p>
<ol>
<li><code>0x4024b0</code>处存储着字符串<code>maduiersnfotvbylSo you think you can stop the bomb with ctrl-c , do you?</code></li>
<li><code>0x40245e</code>处存储着字符串<code>flyers</code></li>
<li>要求经过6次迭代处理的字符串(rsp+0x10)位置与<code>flyers</code>完全相同</li>
<li>现在的结果是<code>aduier</code></li>
</ol>
<p>尝试是否是简单顺序替换</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="plaintext"><code><span class="line"><span>ffcdef</span></span></code></pre>
<p>发现似乎变成了</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="plaintext"><code><span class="line"><span>rruier</span></span></code></pre>
<p>显然是不对的</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">13│</span><span style="color:#79B8FF">    0x000000000040108b</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+4</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    movzbl</span><span style="color:#E1E4E8"> (%rbx,%rax,1),%ecx</span></span>
<span class="line"><span style="color:#B392F0">14│</span><span style="color:#79B8FF">    0x000000000040108f</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+4</span><span style="color:#F97583">5></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    mov</span><span style="color:#9ECBFF">    %cl,</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rsp</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#B392F0">15│</span><span style="color:#79B8FF">    0x0000000000401092</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+4</span><span style="color:#F97583">8></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    mov</span><span style="color:#E1E4E8">    (%rsp),%rdx</span></span>
<span class="line"><span style="color:#B392F0">16│</span><span style="color:#79B8FF">    0x0000000000401096</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+5</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    and</span><span style="color:#E1E4E8">    $0xf</span><span style="color:#9ECBFF">,%edx</span></span>
<span class="line"><span style="color:#B392F0">17│</span><span style="color:#79B8FF">    0x0000000000401099</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+5</span><span style="color:#F97583">5></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    movzbl</span><span style="color:#79B8FF"> 0x4024b0</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rdx</span><span style="color:#E1E4E8">)</span><span style="color:#9ECBFF">,%edx</span></span>
<span class="line"><span style="color:#B392F0">18│</span><span style="color:#79B8FF">    0x00000000004010a0</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+6</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    mov</span><span style="color:#9ECBFF">    %dl,0x10</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rsp,%rax,1</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#B392F0">19│</span><span style="color:#79B8FF">    0x00000000004010a4</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+6</span><span style="color:#F97583">6></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    add</span><span style="color:#E1E4E8">    $0x1</span><span style="color:#9ECBFF">,%rax</span></span>
<span class="line"><span style="color:#B392F0">20│</span><span style="color:#79B8FF">    0x00000000004010a8</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+7</span><span style="color:#F97583">0></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    cmp</span><span style="color:#E1E4E8">    $0x6</span><span style="color:#9ECBFF">,%rax</span></span>
<span class="line"><span style="color:#B392F0">21│</span><span style="color:#79B8FF">    0x00000000004010ac</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+7</span><span style="color:#F97583">4></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    jne</span><span style="color:#79B8FF">    0x40108b</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_5+4</span><span style="color:#F97583">1></span></span></code></pre>
<p>仔细分析这样的循环并倒推一下代码可见只有
<code>18│    0x00000000004010a0 &#x3C;+62>:    mov    %dl,0x10(%rsp,%rax,1)</code>
对我们输入的结果产生了影响</p>
<p>又发现</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">13│</span><span style="color:#79B8FF">    0x000000000040108b</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+4</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    movzbl</span><span style="color:#E1E4E8"> (%rbx,%rax,1),%ecx</span></span>
<span class="line"><span style="color:#B392F0">14│</span><span style="color:#79B8FF">    0x000000000040108f</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+4</span><span style="color:#F97583">5></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    mov</span><span style="color:#9ECBFF">    %cl,</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rsp</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#B392F0">15│</span><span style="color:#79B8FF">    0x0000000000401092</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+4</span><span style="color:#F97583">8></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    mov</span><span style="color:#E1E4E8">    (%rsp),%rdx</span></span>
<span class="line"><span style="color:#B392F0">16│</span><span style="color:#79B8FF">    0x0000000000401096</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+5</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    and</span><span style="color:#E1E4E8">    $0xf</span><span style="color:#9ECBFF">,%edx</span></span>
<span class="line"><span style="color:#B392F0">17│</span><span style="color:#79B8FF">    0x0000000000401099</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+5</span><span style="color:#F97583">5></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    movzbl</span><span style="color:#79B8FF"> 0x4024b0</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rdx</span><span style="color:#E1E4E8">)</span><span style="color:#9ECBFF">,%edx</span></span></code></pre>
<p>利用输入字符的ascii码赋值了edx,下面贴出ascii码表，发现0x4024b0处存储的字符完全满足<code>flyers</code>母集的特征，因此。需满足输入字符为低4位满足与<code>9，15,14,5,6,7</code>相等即可</p>
<p><img src="https://s2.loli.net/2025/08/13/ajZ7t4OXLVgmWJE.png" alt="什么是ASCII码？-CSDN博客" loading="lazy" decoding="async" class="mx-auto rounded-lg shadow" srcset="https://s2.loli.net/2025/08/13/ajZ7t4OXLVgmWJE.png?w=640 640w, https://s2.loli.net/2025/08/13/ajZ7t4OXLVgmWJE.png?w=1280 1280w" sizes="(max-width: 768px) 100vw, 768px"></p>
<p>随意构造一个</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#E1E4E8">)/.%&#x26;'</span></span></code></pre>
<h2 id="phase_6-last_stage">phase_6 LAST_STAGE</h2>
<p><em><strong>Finally！！！</strong></em></p>
<p>简单查看.s确定初始为6个数字。</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">1</span><span style="color:#79B8FF"> 2</span><span style="color:#79B8FF"> 3</span><span style="color:#79B8FF"> 4</span><span style="color:#79B8FF"> 5</span><span style="color:#79B8FF"> 6</span></span></code></pre>
<p>简单运行</p>
<ol>
<li>r13存储的是rsp的地址</li>
<li>第一个值-1 &#x3C;= 5</li>
</ol>
<p>修改为</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">6</span><span style="color:#79B8FF"> 2</span><span style="color:#79B8FF"> 3</span><span style="color:#79B8FF"> 4</span><span style="color:#79B8FF"> 5</span><span style="color:#79B8FF"> 6</span></span></code></pre>
<blockquote>
<p>r12d会自动将r12的高32位清零</p>
</blockquote>
<p>随后遇到一个分支比较r12d的数值，为6。估计是一个循环，找一下</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">13│</span><span style="color:#79B8FF">    0x0000000000401114</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+3</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    mov</span><span style="color:#9ECBFF">    %r13,%rbp</span></span>
<span class="line"><span style="color:#B392F0">14│</span><span style="color:#79B8FF">    0x0000000000401117</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+3</span><span style="color:#F97583">5></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    mov</span><span style="color:#79B8FF">    0x0</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%r13</span><span style="color:#E1E4E8">)</span><span style="color:#9ECBFF">,%eax</span></span>
<span class="line"><span style="color:#B392F0">15│</span><span style="color:#79B8FF">    0x000000000040111b</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+3</span><span style="color:#F97583">9></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    sub</span><span style="color:#E1E4E8">    $0x1</span><span style="color:#9ECBFF">,%eax</span></span>
<span class="line"><span style="color:#B392F0">16│</span><span style="color:#79B8FF">    0x000000000040111e</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+4</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    cmp</span><span style="color:#E1E4E8">    $0x5</span><span style="color:#9ECBFF">,%eax</span></span>
<span class="line"><span style="color:#B392F0">17│</span><span style="color:#79B8FF">    0x0000000000401121</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+4</span><span style="color:#F97583">5></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    jbe</span><span style="color:#79B8FF">    0x401128</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+5</span><span style="color:#F97583">2></span></span>
<span class="line"><span style="color:#B392F0">18│</span><span style="color:#79B8FF">    0x0000000000401123</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+4</span><span style="color:#F97583">7></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    call</span><span style="color:#79B8FF">   0x40143a</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">explode_bom</span><span style="color:#E1E4E8">b</span><span style="color:#F97583">></span></span>
<span class="line"><span style="color:#B392F0">19│</span><span style="color:#79B8FF">    0x0000000000401128</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+5</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    add</span><span style="color:#E1E4E8">    $0x1</span><span style="color:#9ECBFF">,%r12d</span></span>
<span class="line"><span style="color:#B392F0">20├──</span><span style="color:#E1E4E8">> </span><span style="color:#79B8FF">0x000000000040112c</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+5</span><span style="color:#F97583">6></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    cmp</span><span style="color:#E1E4E8">    $0x6</span><span style="color:#9ECBFF">,%r12d</span></span>
<span class="line"><span style="color:#B392F0">21│</span><span style="color:#79B8FF">    0x0000000000401130</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+6</span><span style="color:#F97583">0></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    je</span><span style="color:#79B8FF">     0x401153</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+9</span><span style="color:#F97583">5></span></span>
<span class="line"><span style="color:#B392F0">22│</span><span style="color:#79B8FF">    0x0000000000401132</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+6</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    mov</span><span style="color:#9ECBFF">    %r12d,%ebx</span></span>
<span class="line"><span style="color:#B392F0">23│</span><span style="color:#79B8FF">    0x0000000000401135</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+6</span><span style="color:#F97583">5></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    movslq</span><span style="color:#9ECBFF"> %ebx,%rax</span></span>
<span class="line"><span style="color:#B392F0">24│</span><span style="color:#79B8FF">    0x0000000000401138</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+6</span><span style="color:#F97583">8></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    mov</span><span style="color:#E1E4E8">    (%rsp,%rax,4),%eax</span></span>
<span class="line"><span style="color:#B392F0">25│</span><span style="color:#79B8FF">    0x000000000040113b</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+7</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    cmp</span><span style="color:#9ECBFF">    %eax,0x0</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rbp</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#B392F0">26│</span><span style="color:#79B8FF">    0x000000000040113e</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+7</span><span style="color:#F97583">4></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    jne</span><span style="color:#79B8FF">    0x401145</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+8</span><span style="color:#F97583">1></span></span>
<span class="line"><span style="color:#B392F0">27│</span><span style="color:#79B8FF">    0x0000000000401140</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+7</span><span style="color:#F97583">6></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    call</span><span style="color:#79B8FF">   0x40143a</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">explode_bom</span><span style="color:#E1E4E8">b</span><span style="color:#F97583">></span></span>
<span class="line"><span style="color:#B392F0">28│</span><span style="color:#79B8FF">    0x0000000000401145</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+8</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    add</span><span style="color:#E1E4E8">    $0x1</span><span style="color:#9ECBFF">,%ebx</span></span>
<span class="line"><span style="color:#B392F0">29│</span><span style="color:#79B8FF">    0x0000000000401148</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+8</span><span style="color:#F97583">4></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    cmp</span><span style="color:#E1E4E8">    $0x5</span><span style="color:#9ECBFF">,%ebx</span></span>
<span class="line"><span style="color:#B392F0">30│</span><span style="color:#79B8FF">    0x000000000040114b</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+8</span><span style="color:#F97583">7></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    jle</span><span style="color:#79B8FF">    0x401135</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+6</span><span style="color:#F97583">5></span></span>
<span class="line"><span style="color:#B392F0">31│</span><span style="color:#79B8FF">    0x000000000040114d</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+8</span><span style="color:#F97583">9></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    add</span><span style="color:#E1E4E8">    $0x4</span><span style="color:#9ECBFF">,%r13</span></span>
<span class="line"><span style="color:#B392F0">32│</span><span style="color:#79B8FF">    0x0000000000401151</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+9</span><span style="color:#F97583">3></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    jmp</span><span style="color:#79B8FF">    0x401114</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+3</span><span style="color:#F97583">2></span></span></code></pre>
<p>可见这是个嵌套循环，二级循环如下</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">23│</span><span style="color:#79B8FF">    0x0000000000401135</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+6</span><span style="color:#F97583">5></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    movslq</span><span style="color:#9ECBFF"> %ebx,%rax</span></span>
<span class="line"><span style="color:#B392F0">24│</span><span style="color:#79B8FF">    0x0000000000401138</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+6</span><span style="color:#F97583">8></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    mov</span><span style="color:#E1E4E8">    (%rsp,%rax,4),%eax</span></span>
<span class="line"><span style="color:#B392F0">25│</span><span style="color:#79B8FF">    0x000000000040113b</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+7</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    cmp</span><span style="color:#9ECBFF">    %eax,0x0</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rbp</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#B392F0">26│</span><span style="color:#79B8FF">    0x000000000040113e</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+7</span><span style="color:#F97583">4></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    jne</span><span style="color:#79B8FF">    0x401145</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+8</span><span style="color:#F97583">1></span></span>
<span class="line"><span style="color:#B392F0">27│</span><span style="color:#79B8FF">    0x0000000000401140</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+7</span><span style="color:#F97583">6></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    call</span><span style="color:#79B8FF">   0x40143a</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">explode_bom</span><span style="color:#E1E4E8">b</span><span style="color:#F97583">></span></span>
<span class="line"><span style="color:#B392F0">28│</span><span style="color:#79B8FF">    0x0000000000401145</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+8</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    add</span><span style="color:#E1E4E8">    $0x1</span><span style="color:#9ECBFF">,%ebx</span></span>
<span class="line"><span style="color:#B392F0">29│</span><span style="color:#79B8FF">    0x0000000000401148</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+8</span><span style="color:#F97583">4></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    cmp</span><span style="color:#E1E4E8">    $0x5</span><span style="color:#9ECBFF">,%ebx</span></span>
<span class="line"><span style="color:#B392F0">30│</span><span style="color:#79B8FF">    0x000000000040114b</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+8</span><span style="color:#F97583">7></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    jle</span><span style="color:#79B8FF">    0x401135</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+6</span><span style="color:#F97583">5></span></span></code></pre>
<p>第一个循环的退出为<code>%r12d 1-6</code></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">20│</span><span style="color:#79B8FF">    0x000000000040112c</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+5</span><span style="color:#F97583">6></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    cmp</span><span style="color:#E1E4E8">    $0x6</span><span style="color:#9ECBFF">,%r12d</span></span>
<span class="line"><span style="color:#B392F0">21│</span><span style="color:#79B8FF">    0x0000000000401130</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+6</span><span style="color:#F97583">0></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    je</span><span style="color:#79B8FF">     0x401153</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+9</span><span style="color:#F97583">5></span></span></code></pre>
<p>第二个循环的退出为<code>%ebx %r12d-5</code></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">22│</span><span style="color:#79B8FF">    0x0000000000401132</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+6</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    mov</span><span style="color:#9ECBFF">    %r12d,%ebx</span></span>
<span class="line"><span style="color:#79B8FF">...</span></span>
<span class="line"><span style="color:#B392F0">29│</span><span style="color:#79B8FF">    0x0000000000401148</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+8</span><span style="color:#F97583">4></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    cmp</span><span style="color:#E1E4E8">    $0x5</span><span style="color:#9ECBFF">,%ebx</span></span></code></pre>
<p>首先注意到二级循环的eax不能等于(rbp)(由r13赋值，即第一个参数),查看ax的赋值过程，由栈赋值，循环1-5中的所有值。后面的每个数不能与bp指向的数出现重复。</p>
<p>再来看外层循环，这个循环很简单，就是不断迭代栈中的每个元素，并为二级循环做初始化</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">13│</span><span style="color:#79B8FF">    0x0000000000401114</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+3</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    mov</span><span style="color:#9ECBFF">    %r13,%rbp</span></span>
<span class="line"><span style="color:#B392F0">14│</span><span style="color:#79B8FF">    0x0000000000401117</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+3</span><span style="color:#F97583">5></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    mov</span><span style="color:#79B8FF">    0x0</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%r13</span><span style="color:#E1E4E8">)</span><span style="color:#9ECBFF">,%eax</span></span>
<span class="line"><span style="color:#B392F0">15│</span><span style="color:#79B8FF">    0x000000000040111b</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+3</span><span style="color:#F97583">9></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    sub</span><span style="color:#E1E4E8">    $0x1</span><span style="color:#9ECBFF">,%eax</span></span>
<span class="line"><span style="color:#B392F0">16│</span><span style="color:#79B8FF">    0x000000000040111e</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+4</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    cmp</span><span style="color:#E1E4E8">    $0x5</span><span style="color:#9ECBFF">,%eax</span></span>
<span class="line"><span style="color:#B392F0">17│</span><span style="color:#79B8FF">    0x0000000000401121</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+4</span><span style="color:#F97583">5></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    jbe</span><span style="color:#79B8FF">    0x401128</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+5</span><span style="color:#F97583">2></span></span>
<span class="line"><span style="color:#B392F0">18│</span><span style="color:#79B8FF">    0x0000000000401123</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+4</span><span style="color:#F97583">7></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    call</span><span style="color:#79B8FF">   0x40143a</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">explode_bom</span><span style="color:#E1E4E8">b</span><span style="color:#F97583">></span></span>
<span class="line"><span style="color:#B392F0">19│</span><span style="color:#79B8FF">    0x0000000000401128</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+5</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    add</span><span style="color:#E1E4E8">    $0x1</span><span style="color:#9ECBFF">,%r12d</span></span>
<span class="line"><span style="color:#B392F0">20├──</span><span style="color:#E1E4E8">> </span><span style="color:#79B8FF">0x000000000040112c</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+5</span><span style="color:#F97583">6></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    cmp</span><span style="color:#E1E4E8">    $0x6</span><span style="color:#9ECBFF">,%r12d</span></span>
<span class="line"><span style="color:#B392F0">21│</span><span style="color:#79B8FF">    0x0000000000401130</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+6</span><span style="color:#F97583">0></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    je</span><span style="color:#79B8FF">     0x401153</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+9</span><span style="color:#F97583">5></span></span>
<span class="line"><span style="color:#B392F0">22│</span><span style="color:#79B8FF">    0x0000000000401132</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+6</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    mov</span><span style="color:#9ECBFF">    %r12d,%ebx</span></span>
<span class="line"><span style="color:#79B8FF">...</span></span>
<span class="line"><span style="color:#B392F0">31│</span><span style="color:#79B8FF">    0x000000000040114d</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+8</span><span style="color:#F97583">9></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    add</span><span style="color:#E1E4E8">    $0x4</span><span style="color:#9ECBFF">,%r13</span></span>
<span class="line"><span style="color:#B392F0">32│</span><span style="color:#79B8FF">    0x0000000000401151</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+9</span><span style="color:#F97583">3></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    jmp</span><span style="color:#79B8FF">    0x401114</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+3</span><span style="color:#F97583">2></span></span></code></pre>
<p>首先，他会用r13更新bp为目前迭代的元素，其次，初始化<code>eax</code>,<strong>这说明所有元素都必须小于等于6</strong>。</p>
<p>也就是是一个1-6的排列,修改答案为</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">6</span><span style="color:#79B8FF"> 4</span><span style="color:#79B8FF"> 5</span><span style="color:#79B8FF"> 3</span><span style="color:#79B8FF"> 1</span><span style="color:#79B8FF"> 2</span></span></code></pre>
<p>***好好好！！！***成功跑出了二层循环。</p>
<p>简单看看下面的</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">33├──</span><span style="color:#E1E4E8">> </span><span style="color:#79B8FF">0x0000000000401153</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+9</span><span style="color:#F97583">5></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">    lea</span><span style="color:#79B8FF">    0x18</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rsp</span><span style="color:#E1E4E8">)</span><span style="color:#9ECBFF">,%rsi</span><span style="color:#6A737D"> # rsi 0</span></span>
<span class="line"><span style="color:#B392F0">34│</span><span style="color:#79B8FF">    0x0000000000401158</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+10</span><span style="color:#F97583">0></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#9ECBFF">    %r14,%rax</span><span style="color:#6A737D"> # r14也指向栈顶</span></span>
<span class="line"><span style="color:#B392F0">35│</span><span style="color:#79B8FF">    0x000000000040115b</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+10</span><span style="color:#F97583">3></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#E1E4E8">    $0x7</span><span style="color:#9ECBFF">,%ecx</span></span>
<span class="line"><span style="color:#B392F0">36│</span><span style="color:#79B8FF">    0x0000000000401160</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+10</span><span style="color:#F97583">8></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#9ECBFF">    %ecx,%edx</span></span>
<span class="line"><span style="color:#B392F0">37│</span><span style="color:#79B8FF">    0x0000000000401162</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+11</span><span style="color:#F97583">0></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   sub</span><span style="color:#E1E4E8">    (%rax),%edx</span></span>
<span class="line"><span style="color:#B392F0">38│</span><span style="color:#79B8FF">    0x0000000000401164</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+11</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#9ECBFF">    %edx,</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rax</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#B392F0">39│</span><span style="color:#79B8FF">    0x0000000000401166</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+11</span><span style="color:#F97583">4></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   add</span><span style="color:#E1E4E8">    $0x4</span><span style="color:#9ECBFF">,%rax</span></span>
<span class="line"><span style="color:#B392F0">40│</span><span style="color:#79B8FF">    0x000000000040116a</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+11</span><span style="color:#F97583">8></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   cmp</span><span style="color:#9ECBFF">    %rsi,%rax</span></span>
<span class="line"><span style="color:#B392F0">41│</span><span style="color:#79B8FF">    0x000000000040116d</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+12</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   jne</span><span style="color:#79B8FF">    0x401160</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+10</span><span style="color:#F97583">8></span></span>
<span class="line"><span style="color:#B392F0">42│</span><span style="color:#79B8FF">    0x000000000040116f</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+12</span><span style="color:#F97583">3></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#E1E4E8">    $0x0</span><span style="color:#9ECBFF">,%esi</span></span>
<span class="line"><span style="color:#B392F0">43│</span><span style="color:#79B8FF">    0x0000000000401174</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+12</span><span style="color:#F97583">8></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   jmp</span><span style="color:#79B8FF">    0x401197</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+16</span><span style="color:#F97583">3></span></span>
<span class="line"><span style="color:#B392F0">44│</span><span style="color:#79B8FF">    0x0000000000401176</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+13</span><span style="color:#F97583">0></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#79B8FF">    0x8</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rdx</span><span style="color:#E1E4E8">)</span><span style="color:#9ECBFF">,%rdx</span></span>
<span class="line"><span style="color:#B392F0">45│</span><span style="color:#79B8FF">    0x000000000040117a</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+13</span><span style="color:#F97583">4></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   add</span><span style="color:#E1E4E8">    $0x1</span><span style="color:#9ECBFF">,%eax</span></span>
<span class="line"><span style="color:#B392F0">46│</span><span style="color:#79B8FF">    0x000000000040117d</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+13</span><span style="color:#F97583">7></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   cmp</span><span style="color:#9ECBFF">    %ecx,%eax</span></span>
<span class="line"><span style="color:#B392F0">47│</span><span style="color:#79B8FF">    0x000000000040117f</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+13</span><span style="color:#F97583">9></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   jne</span><span style="color:#79B8FF">    0x401176</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+13</span><span style="color:#F97583">0></span></span>
<span class="line"><span style="color:#B392F0">48│</span><span style="color:#79B8FF">    0x0000000000401181</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+14</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   jmp</span><span style="color:#79B8FF">    0x401188</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+14</span><span style="color:#F97583">8></span></span>
<span class="line"><span style="color:#B392F0">49│</span><span style="color:#79B8FF">    0x0000000000401183</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+14</span><span style="color:#F97583">3></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#E1E4E8">    $0x6032d0</span><span style="color:#9ECBFF">,%edx</span></span>
<span class="line"><span style="color:#B392F0">50│</span><span style="color:#79B8FF">    0x0000000000401188</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+14</span><span style="color:#F97583">8></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#9ECBFF">    %rdx,0x20</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rsp,%rsi,2</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#B392F0">51│</span><span style="color:#79B8FF">    0x000000000040118d</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+15</span><span style="color:#F97583">3></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   add</span><span style="color:#E1E4E8">    $0x4</span><span style="color:#9ECBFF">,%rsi</span></span></code></pre>
<p>顶真出里面有两个循环</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">36│</span><span style="color:#79B8FF">    0x0000000000401160</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+10</span><span style="color:#F97583">8></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#9ECBFF">    %ecx,%edx</span></span>
<span class="line"><span style="color:#B392F0">37│</span><span style="color:#79B8FF">    0x0000000000401162</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+11</span><span style="color:#F97583">0></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   sub</span><span style="color:#E1E4E8">    (%rax),%edx</span></span>
<span class="line"><span style="color:#B392F0">38│</span><span style="color:#79B8FF">    0x0000000000401164</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+11</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#9ECBFF">    %edx,</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rax</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#B392F0">39│</span><span style="color:#79B8FF">    0x0000000000401166</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+11</span><span style="color:#F97583">4></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   add</span><span style="color:#E1E4E8">    $0x4</span><span style="color:#9ECBFF">,%rax</span></span>
<span class="line"><span style="color:#B392F0">40│</span><span style="color:#79B8FF">    0x000000000040116a</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+11</span><span style="color:#F97583">8></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   cmp</span><span style="color:#9ECBFF">    %rsi,%rax</span></span>
<span class="line"><span style="color:#B392F0">41│</span><span style="color:#79B8FF">    0x000000000040116d</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+12</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   jne</span><span style="color:#79B8FF">    0x401160</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+10</span><span style="color:#F97583">8></span></span></code></pre>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">44│</span><span style="color:#79B8FF">    0x0000000000401176</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+13</span><span style="color:#F97583">0></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#79B8FF">    0x8</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rdx</span><span style="color:#E1E4E8">)</span><span style="color:#9ECBFF">,%rdx</span></span>
<span class="line"><span style="color:#B392F0">45│</span><span style="color:#79B8FF">    0x000000000040117a</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+13</span><span style="color:#F97583">4></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   add</span><span style="color:#E1E4E8">    $0x1</span><span style="color:#9ECBFF">,%eax</span></span>
<span class="line"><span style="color:#B392F0">46│</span><span style="color:#79B8FF">    0x000000000040117d</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+13</span><span style="color:#F97583">7></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   cmp</span><span style="color:#9ECBFF">    %ecx,%eax</span></span>
<span class="line"><span style="color:#B392F0">47│</span><span style="color:#79B8FF">    0x000000000040117f</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+13</span><span style="color:#F97583">9></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   jne</span><span style="color:#79B8FF">    0x401176</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+13</span><span style="color:#F97583">0></span></span></code></pre>
<ol>
<li>
<p>cmp %rsi,(%rax) # (rax) = 7 - (rsp) rax = rsp</p>
<p>这说明整个循环1就是为了将数组做一个互补映射 6 -> 1 5 -> 2 …</p>
</li>
<li>
<p>循环2是一个嵌套的二级循环</p>
</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">44│</span><span style="color:#79B8FF">    0x0000000000401176</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+13</span><span style="color:#F97583">0></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#79B8FF">    0x8</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rdx</span><span style="color:#E1E4E8">)</span><span style="color:#9ECBFF">,%rdx</span></span>
<span class="line"><span style="color:#B392F0">45│</span><span style="color:#79B8FF">    0x000000000040117a</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+13</span><span style="color:#F97583">4></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   add</span><span style="color:#E1E4E8">    $0x1</span><span style="color:#9ECBFF">,%eax</span></span>
<span class="line"><span style="color:#B392F0">46│</span><span style="color:#79B8FF">    0x000000000040117d</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+13</span><span style="color:#F97583">7></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   cmp</span><span style="color:#9ECBFF">    %ecx,%eax</span></span>
<span class="line"><span style="color:#B392F0">47│</span><span style="color:#79B8FF">    0x000000000040117f</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+13</span><span style="color:#F97583">9></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   jne</span><span style="color:#79B8FF">    0x401176</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+13</span><span style="color:#F97583">0></span></span>
<span class="line"><span style="color:#B392F0">48│</span><span style="color:#79B8FF">    0x0000000000401181</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+14</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   jmp</span><span style="color:#79B8FF">    0x401188</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+14</span><span style="color:#F97583">8></span></span>
<span class="line"><span style="color:#B392F0">49│</span><span style="color:#79B8FF">    0x0000000000401183</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+14</span><span style="color:#F97583">3></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#E1E4E8">    $0x6032d0</span><span style="color:#9ECBFF">,%edx</span></span>
<span class="line"><span style="color:#B392F0">50│</span><span style="color:#79B8FF">    0x0000000000401188</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+14</span><span style="color:#F97583">8></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#9ECBFF">    %rdx,0x20</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rsp,%rsi,2</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#B392F0">51│</span><span style="color:#79B8FF">    0x000000000040118d</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+15</span><span style="color:#F97583">3></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   add</span><span style="color:#E1E4E8">    $0x4</span><span style="color:#9ECBFF">,%rsi</span></span>
<span class="line"><span style="color:#B392F0">52│</span><span style="color:#79B8FF">    0x0000000000401191</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+15</span><span style="color:#F97583">7></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   cmp</span><span style="color:#E1E4E8">    $0x18</span><span style="color:#9ECBFF">,%rsi</span></span>
<span class="line"><span style="color:#B392F0">53│</span><span style="color:#79B8FF">    0x0000000000401195</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+16</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   je</span><span style="color:#79B8FF">     0x4011ab</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+18</span><span style="color:#F97583">3></span></span>
<span class="line"><span style="color:#B392F0">54│</span><span style="color:#79B8FF">    0x0000000000401197</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+16</span><span style="color:#F97583">3></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#E1E4E8">    (%rsp,%rsi,1),%ecx</span></span>
<span class="line"><span style="color:#B392F0">55│</span><span style="color:#79B8FF">    0x000000000040119a</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+16</span><span style="color:#F97583">6></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   cmp</span><span style="color:#E1E4E8">    $0x1</span><span style="color:#9ECBFF">,%ecx</span></span>
<span class="line"><span style="color:#B392F0">56│</span><span style="color:#79B8FF">    0x000000000040119d</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+16</span><span style="color:#F97583">9></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   jle</span><span style="color:#79B8FF">    0x401183</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+14</span><span style="color:#F97583">3></span></span>
<span class="line"><span style="color:#B392F0">57│</span><span style="color:#79B8FF">    0x000000000040119f</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+17</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#E1E4E8">    $0x1</span><span style="color:#9ECBFF">,%eax</span></span>
<span class="line"><span style="color:#B392F0">58│</span><span style="color:#79B8FF">    0x00000000004011a4</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+17</span><span style="color:#F97583">6></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#E1E4E8">    $0x6032d0</span><span style="color:#9ECBFF">,%edx</span></span>
<span class="line"><span style="color:#B392F0">59│</span><span style="color:#79B8FF">    0x00000000004011a9</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+18</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   jmp</span><span style="color:#79B8FF">    0x401176</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+13</span><span style="color:#F97583">0></span></span></code></pre>
<p>查看一下循环推出的条件</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">51│</span><span style="color:#79B8FF">    0x000000000040118d</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+15</span><span style="color:#F97583">3></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   add</span><span style="color:#E1E4E8">    $0x4</span><span style="color:#9ECBFF">,%rsi</span></span>
<span class="line"><span style="color:#B392F0">52│</span><span style="color:#79B8FF">    0x0000000000401191</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+15</span><span style="color:#F97583">7></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   cmp</span><span style="color:#E1E4E8">    $0x18</span><span style="color:#9ECBFF">,%rsi</span></span>
<span class="line"><span style="color:#B392F0">53│</span><span style="color:#79B8FF">    0x0000000000401195</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+16</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   je</span><span style="color:#79B8FF">     0x4011ab</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+18</span><span style="color:#F97583">3></span></span></code></pre>
<p>要求rsi == 0x18，rsi被初始化为0，即 <code>rsi 0-0x18 0x4</code>，迭代6次，遍历数组</p>
<ol>
<li>此时 0x6030d0的值为-122,加载进rdx时的值为76，rsp+20的值为-48
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"></span></code></pre>
</li>
</ol>
<p>(gdb) x/20wc $rsp
0x7fffffffdb90: 1 ‘\001’        3 ‘\003’        2 ‘\002’        4 ‘\004’
0x7fffffffdba0: 6 ‘\006’        5 ‘\005’        0 ‘\000’        0 ‘\000’
0x7fffffffdbb0: -48 ‘\320’      0 ‘\000’        -16 ‘\360’      0 ‘\000’
0x7fffffffdbc0: -32 ‘\340’      0 ‘\000’        0 ‘\000’        0 ‘\000’
0x7fffffffdbd0: 32 ’ ’  0 ‘\000’        16 ‘\020’       0 ‘\000’
```</p>
<ol start="2">
<li>
<p>其在原数组后新构建了一个数组(每个数字长一个字节)，在本次测试中的结果如下</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="plaintext"><code><span class="line"><span>(gdb) x/6gx $rsp + 0x20</span></span>
<span class="line"><span>0x7fffffffdbb0: 0x00000000006032d0      0x00000000006032f0</span></span>
<span class="line"><span>0x7fffffffdbc0: 0x00000000006032e0      0x0000000000603300</span></span>
<span class="line"><span>0x7fffffffdbd0: 0x0000000000603320      0x0000000000603310</span></span></code></pre>
</li>
</ol>
<p><em><strong>FINNALY!!!</strong></em></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">60│</span><span style="color:#79B8FF">    0x00000000004011ab</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+18</span><span style="color:#F97583">3></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#79B8FF">    0x20</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rsp</span><span style="color:#E1E4E8">)</span><span style="color:#9ECBFF">,%rbx</span></span>
<span class="line"><span style="color:#B392F0">61│</span><span style="color:#79B8FF">    0x00000000004011b0</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+18</span><span style="color:#F97583">8></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   lea</span><span style="color:#79B8FF">    0x28</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rsp</span><span style="color:#E1E4E8">)</span><span style="color:#9ECBFF">,%rax</span></span>
<span class="line"><span style="color:#B392F0">62│</span><span style="color:#79B8FF">    0x00000000004011b5</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+19</span><span style="color:#F97583">3></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   lea</span><span style="color:#79B8FF">    0x50</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rsp</span><span style="color:#E1E4E8">)</span><span style="color:#9ECBFF">,%rsi</span></span>
<span class="line"><span style="color:#B392F0">63│</span><span style="color:#79B8FF">    0x00000000004011ba</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+19</span><span style="color:#F97583">8></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#9ECBFF">    %rbx,%rcx</span></span>
<span class="line"><span style="color:#B392F0">64│</span><span style="color:#79B8FF">    0x00000000004011bd</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+20</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#E1E4E8">    (%rax),%rdx</span></span>
<span class="line"><span style="color:#B392F0">65│</span><span style="color:#79B8FF">    0x00000000004011c0</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+20</span><span style="color:#F97583">4></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#9ECBFF">    %rdx,0x8</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rcx</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#B392F0">66│</span><span style="color:#79B8FF">    0x00000000004011c4</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+20</span><span style="color:#F97583">8></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   add</span><span style="color:#E1E4E8">    $0x8</span><span style="color:#9ECBFF">,%rax</span></span>
<span class="line"><span style="color:#B392F0">67│</span><span style="color:#79B8FF">    0x00000000004011c8</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+21</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   cmp</span><span style="color:#9ECBFF">    %rsi,%rax</span></span>
<span class="line"><span style="color:#B392F0">68│</span><span style="color:#79B8FF">    0x00000000004011cb</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+21</span><span style="color:#F97583">5></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   je</span><span style="color:#79B8FF">     0x4011d2</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+22</span><span style="color:#F97583">2></span></span>
<span class="line"><span style="color:#B392F0">69│</span><span style="color:#79B8FF">    0x00000000004011cd</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+21</span><span style="color:#F97583">7></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#9ECBFF">    %rdx,%rcx</span></span>
<span class="line"><span style="color:#B392F0">70│</span><span style="color:#79B8FF">    0x00000000004011d0</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+22</span><span style="color:#F97583">0></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   jmp</span><span style="color:#79B8FF">    0x4011bd</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+20</span><span style="color:#F97583">1></span></span>
<span class="line"><span style="color:#B392F0">71│</span><span style="color:#79B8FF">    0x00000000004011d2</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+22</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   movq</span><span style="color:#E1E4E8">   $0x0</span><span style="color:#9ECBFF">,0x8</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rdx</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#B392F0">72│</span><span style="color:#79B8FF">    0x00000000004011da</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+23</span><span style="color:#F97583">0></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#E1E4E8">    $0x5</span><span style="color:#9ECBFF">,%ebp</span></span>
<span class="line"><span style="color:#B392F0">73│</span><span style="color:#79B8FF">    0x00000000004011df</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+23</span><span style="color:#F97583">5></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#79B8FF">    0x8</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rbx</span><span style="color:#E1E4E8">)</span><span style="color:#9ECBFF">,%rax</span></span>
<span class="line"><span style="color:#B392F0">74│</span><span style="color:#79B8FF">    0x00000000004011e3</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+23</span><span style="color:#F97583">9></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#E1E4E8">    (%rax),%eax</span></span>
<span class="line"><span style="color:#B392F0">75│</span><span style="color:#79B8FF">    0x00000000004011e5</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+24</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   cmp</span><span style="color:#9ECBFF">    %eax,</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rbx</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#B392F0">76│</span><span style="color:#79B8FF">    0x00000000004011e7</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+24</span><span style="color:#F97583">3></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   jge</span><span style="color:#79B8FF">    0x4011ee</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+25</span><span style="color:#F97583">0></span></span>
<span class="line"><span style="color:#B392F0">77│</span><span style="color:#79B8FF">    0x00000000004011e9</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+24</span><span style="color:#F97583">5></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   call</span><span style="color:#79B8FF">   0x40143a</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">explode_bom</span><span style="color:#E1E4E8">b</span><span style="color:#F97583">></span></span>
<span class="line"><span style="color:#B392F0">78│</span><span style="color:#79B8FF">    0x00000000004011ee</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+25</span><span style="color:#F97583">0></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#79B8FF">    0x8</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rbx</span><span style="color:#E1E4E8">)</span><span style="color:#9ECBFF">,%rbx</span></span>
<span class="line"><span style="color:#B392F0">79│</span><span style="color:#79B8FF">    0x00000000004011f2</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+25</span><span style="color:#F97583">4></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   sub</span><span style="color:#E1E4E8">    $0x1</span><span style="color:#9ECBFF">,%ebp</span></span>
<span class="line"><span style="color:#B392F0">80│</span><span style="color:#79B8FF">    0x00000000004011f5</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+25</span><span style="color:#F97583">7></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   jne</span><span style="color:#79B8FF">    0x4011df</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+23</span><span style="color:#F97583">5></span></span></code></pre>
<p>注意到循环</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">64│</span><span style="color:#79B8FF">    0x00000000004011bd</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+20</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#E1E4E8">    (%rax),%rdx</span></span>
<span class="line"><span style="color:#B392F0">65│</span><span style="color:#79B8FF">    0x00000000004011c0</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+20</span><span style="color:#F97583">4></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#9ECBFF">    %rdx,0x8</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rcx</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#B392F0">66│</span><span style="color:#79B8FF">    0x00000000004011c4</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+20</span><span style="color:#F97583">8></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   add</span><span style="color:#E1E4E8">    $0x8</span><span style="color:#9ECBFF">,%rax</span></span>
<span class="line"><span style="color:#B392F0">67│</span><span style="color:#79B8FF">    0x00000000004011c8</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+21</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   cmp</span><span style="color:#9ECBFF">    %rsi,%rax</span></span>
<span class="line"><span style="color:#B392F0">68│</span><span style="color:#79B8FF">    0x00000000004011cb</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+21</span><span style="color:#F97583">5></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   je</span><span style="color:#79B8FF">     0x4011d2</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+22</span><span style="color:#F97583">2></span></span>
<span class="line"><span style="color:#B392F0">69│</span><span style="color:#79B8FF">    0x00000000004011cd</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+21</span><span style="color:#F97583">7></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#9ECBFF">    %rdx,%rcx</span></span>
<span class="line"><span style="color:#B392F0">70│</span><span style="color:#79B8FF">    0x00000000004011d0</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+22</span><span style="color:#F97583">0></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   jmp</span><span style="color:#79B8FF">    0x4011bd</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+20</span><span style="color:#F97583">1></span></span></code></pre>
<p>这是遍历后面数组的前五位，并处理0x6032e0 - 0x663320位置的值</p>
<blockquote>
<p>这里实际上是在链接节点</p>
</blockquote>
<p>且最后一个explode_bomb是</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">73│</span><span style="color:#79B8FF">    0x00000000004011df</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+23</span><span style="color:#F97583">5></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#79B8FF">    0x8</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rbx</span><span style="color:#E1E4E8">)</span><span style="color:#9ECBFF">,%rax</span></span>
<span class="line"><span style="color:#B392F0">74├──</span><span style="color:#E1E4E8">> </span><span style="color:#79B8FF">0x00000000004011e3</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+23</span><span style="color:#F97583">9></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#E1E4E8">    (%rax),%eax</span></span>
<span class="line"><span style="color:#B392F0">75│</span><span style="color:#79B8FF">    0x00000000004011e5</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+24</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   cmp</span><span style="color:#9ECBFF">    %eax,</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rbx</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#B392F0">76│</span><span style="color:#79B8FF">    0x00000000004011e7</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+24</span><span style="color:#F97583">3></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   jge</span><span style="color:#79B8FF">    0x4011ee</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+25</span><span style="color:#F97583">0></span></span>
<span class="line"><span style="color:#B392F0">77│</span><span style="color:#79B8FF">    0x00000000004011e9</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+24</span><span style="color:#F97583">5></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   call</span><span style="color:#79B8FF">   0x40143a</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">explode_bom</span><span style="color:#E1E4E8">b</span><span style="color:#F97583">></span></span>
<span class="line"><span style="color:#B392F0">78│</span><span style="color:#79B8FF">    0x00000000004011ee</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+25</span><span style="color:#F97583">0></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   mov</span><span style="color:#79B8FF">    0x8</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">%rbx</span><span style="color:#E1E4E8">)</span><span style="color:#9ECBFF">,%rbx</span></span>
<span class="line"><span style="color:#B392F0">79│</span><span style="color:#79B8FF">    0x00000000004011f2</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+25</span><span style="color:#F97583">4></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   sub</span><span style="color:#E1E4E8">    $0x1</span><span style="color:#9ECBFF">,%ebp</span></span>
<span class="line"><span style="color:#B392F0">80│</span><span style="color:#79B8FF">    0x00000000004011f5</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">+25</span><span style="color:#F97583">7></span><span style="color:#9ECBFF">:</span><span style="color:#9ECBFF">   jne</span><span style="color:#79B8FF">    0x4011df</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">phase_6+23</span><span style="color:#F97583">5></span></span></code></pre>
<p>执行下去，发现对于0x6032d0位置与0x6032f0位置的值的比较爆炸了，即<code>cmp    %eax,(%rbx)</code>的比较重rbx的值大于rax，具体的是</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#E1E4E8">(</span><span style="color:#B392F0">gdb</span><span style="color:#E1E4E8">) </span><span style="color:#B392F0">x/x</span><span style="color:#E1E4E8"> $rbx</span></span>
<span class="line"><span style="color:#B392F0">0x6032d0</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">node</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#79B8FF">       0x000000010000014c</span></span>
<span class="line"><span style="color:#E1E4E8">(</span><span style="color:#B392F0">gdb</span><span style="color:#E1E4E8">) </span><span style="color:#B392F0">p/x</span><span style="color:#E1E4E8"> $rax</span></span>
<span class="line"><span style="color:#E1E4E8">$106 = 0x39c</span></span>
<span class="line"><span style="color:#E1E4E8">(</span><span style="color:#B392F0">gdb</span><span style="color:#E1E4E8">) </span><span style="color:#B392F0">x/x</span><span style="color:#E1E4E8"> $rbx </span><span style="color:#9ECBFF">+</span><span style="color:#79B8FF"> 8</span></span>
<span class="line"><span style="color:#B392F0">0x6032d8</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">node1+</span><span style="color:#F97583">8></span><span style="color:#9ECBFF">:</span><span style="color:#79B8FF">     0x00000000006032f0</span></span>
<span class="line"><span style="color:#E1E4E8">(</span><span style="color:#B392F0">gdb</span><span style="color:#E1E4E8">) </span><span style="color:#B392F0">p/x</span><span style="color:#E1E4E8"> $rax</span></span>
<span class="line"><span style="color:#E1E4E8">$105 = 0x39c</span></span>
<span class="line"><span style="color:#E1E4E8">(</span><span style="color:#B392F0">gdb</span><span style="color:#E1E4E8">) </span><span style="color:#B392F0">x/x</span><span style="color:#79B8FF"> 0x6032f0</span></span>
<span class="line"><span style="color:#B392F0">0x6032f0</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">node</span><span style="color:#F97583">3></span><span style="color:#9ECBFF">:</span><span style="color:#79B8FF">       0x000000030000039c</span></span></code></pre>
<p>这里从eax向rax转移时不仅出现了*解释的情况，而且出现了32->64的0填补扩充解释。</p>
<p>这时让我们回到上面的根据第二个数组简历0x60系列数据的循环。根据其中写入的值找到一个非递增的序列即可。</p>
<blockquote>
<p>注：这里很难理解，但注意前面的循环，实际上整个过程是在创建连边0x603空间中的值实际上是malloc出来的空间，整个函数实际上就是要找出链表中的非递增节点排序。逆天的难度是由于需要<strong>对齐！！！</strong>，前面两个数据后面一个padding，一个节点地址。</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#E1E4E8">(</span><span style="color:#B392F0">gdb</span><span style="color:#E1E4E8">) </span><span style="color:#B392F0">x/12x</span><span style="color:#79B8FF"> 0x6032d0</span></span>
<span class="line"><span style="color:#B392F0">0x6032d0</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">node</span><span style="color:#F97583">1></span><span style="color:#9ECBFF">:</span><span style="color:#79B8FF">       0x000000010000014c</span><span style="color:#79B8FF">      0x00000000006032f0</span></span>
<span class="line"><span style="color:#B392F0">0x6032e0</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">node</span><span style="color:#F97583">2></span><span style="color:#9ECBFF">:</span><span style="color:#79B8FF">       0x00000002000000a8</span><span style="color:#79B8FF">      0x0000000000603300</span></span>
<span class="line"><span style="color:#B392F0">0x6032f0</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">node</span><span style="color:#F97583">3></span><span style="color:#9ECBFF">:</span><span style="color:#79B8FF">       0x000000030000039c</span><span style="color:#79B8FF">      0x00000000006032e0</span></span>
<span class="line"><span style="color:#B392F0">0x603300</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">node</span><span style="color:#F97583">4></span><span style="color:#9ECBFF">:</span><span style="color:#79B8FF">       0x00000004000002b3</span><span style="color:#79B8FF">      0x0000000000603320</span></span>
<span class="line"><span style="color:#B392F0">0x603310</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">node</span><span style="color:#F97583">5></span><span style="color:#9ECBFF">:</span><span style="color:#79B8FF">       0x00000005000001dd</span><span style="color:#79B8FF">      0x0000000000000000</span></span>
<span class="line"><span style="color:#B392F0">0x603320</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF">node</span><span style="color:#F97583">6></span><span style="color:#9ECBFF">:</span><span style="color:#79B8FF">       0x00000006000001bb</span><span style="color:#79B8FF">      0x0000000000603310</span></span></code></pre>
<p>清晰可见整个链表的结构</p>
</blockquote>
<p><img src="https://s2.loli.net/2025/08/13/Lw4mVUrdBXQl5FT.jpg" alt="img" loading="lazy" decoding="async" class="mx-auto rounded-lg shadow" srcset="https://s2.loli.net/2025/08/13/Lw4mVUrdBXQl5FT.jpg?w=640 640w, https://s2.loli.net/2025/08/13/Lw4mVUrdBXQl5FT.jpg?w=1280 1280w" sizes="(max-width: 768px) 100vw, 768px"></p>
<p>最后得到答案就是(注意取补)</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">4</span><span style="color:#79B8FF"> 3</span><span style="color:#79B8FF"> 2</span><span style="color:#79B8FF"> 1</span><span style="color:#79B8FF"> 6</span><span style="color:#79B8FF"> 5</span></span></code></pre>
<p><em><strong>Congratulations! You’ve defused the bomb!</strong></em></p>
<h2 id="regs-ref">regs ref</h2>
<p>rbp base point基址指针寄存器
rbx base 基址寄存器
rsp 栈顶寄存器</p>
<p>rbx，rbp，r12，r13，14，15 用作数据存储，遵循被调用者使用规则，简单说就是随便用，调用子函数之前要备份它，以防他被修改</p>
<p>al寄存器是rax八位寄存器的一部分（地位），还有相似的其他寄存器，例如bl等</p>

































<table><thead><tr><th>参数号</th><th>对应寄存器</th></tr></thead><tbody><tr><td>第 1 个</td><td>RDI</td></tr><tr><td>第 2 个</td><td>RSI</td></tr><tr><td>第 3 个</td><td>RDX</td></tr><tr><td>第 4 个</td><td>RCX</td></tr><tr><td>第 5 个</td><td>R8</td></tr><tr><td>第 6 个</td><td>R9</td></tr></tbody></table>
<h2 id="command-ref">command ref</h2>
<h3 id="lea">lea</h3>
<p>lea Load Effective Address</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="plaintext"><code><span class="line"><span>lea  源地址,  目的寄存器</span></span>
<span class="line"><span>lea  0x10(%rax), %rbx</span></span></code></pre>
<p>将 %rax + 0x10 这个地址的值，存入 %rbx
&#x3C;==>rbx = rax + 0x10;</p>
<p>tip:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="plaintext"><code><span class="line"><span>lea  (%rax, %rax, 2), %rdx</span></span></code></pre>
<p>计算：%rax + %rax * 2 = 3 * %rax
所以 %rdx = 3 * %rax</p>
<h3 id="cmp">cmp</h3>
<p>比较两个数据是否相等</p>
<p>eg:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">cmp</span><span style="color:#9ECBFF"> %eax</span><span style="color:#9ECBFF"> %r12d</span><span style="color:#6A737D">	# 后者在前，前者在后的比较大小</span></span></code></pre>
<p>就是比较寄存器eax与r12d的值，该命令会更改标志寄存器，常与jne,je搭配使用跳转函数</p>
<h3 id="movzbl-与-扩展命令">movzbl 与 扩展命令</h3>
<blockquote>
<p>MovZero-extended Byte to Long</p>
</blockquote>
<p>将一个 8 位的字节（byte） 零扩展为 32 位的整数（long），并存入目标寄存器。</p>
<p>这类“扩展命令”还有很多，基本是零扩展与符号扩展</p>









































<table><thead><tr><th>指令</th><th>含义</th><th>源 → 目标</th><th>示例</th></tr></thead><tbody><tr><td>movzbl</td><td>Move Zero-extended Byte to Long</td><td>8 → 32</td><td>movzbl %al, %eax</td></tr><tr><td>movzwl</td><td>Move Zero-extended Word to Long</td><td>16 → 32</td><td>movzwl %ax, %eax</td></tr><tr><td>movzbq</td><td>Move Zero-extended Byte to Quad</td><td>8 → 64</td><td>movzbq %al, %rax</td></tr><tr><td>movzwq</td><td>Move Zero-extended Word to Quad</td><td>16 → 64</td><td>movzwq %ax, %rax</td></tr><tr><td>movzlq</td><td>Move Zero-extended Long to Quad</td><td>32 → 64</td><td>movzlq %ax, %rax</td></tr></tbody></table>
<h3 id="test">test</h3>
<p>对两个操作数进行 按位与（bitwise AND） 运算，但不保存结果，只根据结果 更新标志寄存器（EFLAGS）</p>
<p>equal</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">//</span><span style="color:#9ECBFF"> test</span><span style="color:#9ECBFF"> %eax,</span><span style="color:#9ECBFF"> %eax</span><span style="color:#9ECBFF"> 相当于：</span></span>
<span class="line"><span style="color:#F97583">if</span><span style="color:#E1E4E8"> (</span><span style="color:#B392F0">eax</span><span style="color:#E1E4E8"> &#x26; </span><span style="color:#B392F0">eax</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#B392F0">    //</span><span style="color:#9ECBFF"> 非零</span><span style="color:#9ECBFF"> →</span><span style="color:#9ECBFF"> ZF</span><span style="color:#9ECBFF"> =</span><span style="color:#79B8FF"> 0</span></span>
<span class="line"><span style="color:#E1E4E8">} </span><span style="color:#F97583">else</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#B392F0">    //</span><span style="color:#9ECBFF"> 为零</span><span style="color:#9ECBFF"> →</span><span style="color:#9ECBFF"> ZF</span><span style="color:#9ECBFF"> =</span><span style="color:#79B8FF"> 1</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h3 id="nopl">nopl</h3>
<blockquote>
<p>No Operation Long</p>
</blockquote>
<p>不执行任何有意义的操作（does nothing）,只是占用一个时钟周期（极短），用于填充（padding）,主要用于 对齐指令边界 或 填充空间</p>
<h3 id="jg-以及相似的条件判断语句">jg 以及相似的条件判断语句</h3>









































<table><thead><tr><th>指令</th><th>全称</th><th>比较类型</th><th>用途</th></tr></thead><tbody><tr><td>jg</td><td>jump if greater</td><td>有符号（signed）</td><td>比较 int、long 等带符号数</td></tr><tr><td>jl</td><td>jump if less</td><td>有符号</td><td>a &#x3C; b</td></tr><tr><td>je</td><td>jump if equal</td><td>相等</td><td>a == b</td></tr><tr><td>ja</td><td>jump if above</td><td>无符号（unsigned）</td><td>比较地址、unsigned int</td></tr><tr><td>jb</td><td>jump if below</td><td>无符号</td><td>a &#x3C; b（无符号）</td></tr></tbody></table>
<h3 id="shr">shr</h3>
<p>Shift Right</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">shr</span><span style="color:#E1E4E8"> $n</span><span style="color:#9ECBFF">,</span><span style="color:#9ECBFF"> %reg</span><span style="color:#6A737D">        # 将寄存器右移 n 位</span></span></code></pre>
<blockquote>
<p>⚠️ 注意：AT&#x26;T 语法是 shr $移动位数, 源操作数</p>
</blockquote>
<h3 id="add-sub">add 、sub</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="plaintext"><code><span class="line"><span>add\sub 源操作数, 目标操作数</span></span>
<span class="line"><span></span></span>
<span class="line"><span>目标 = 目标 +\- 源</span></span>
<span class="line"><span></span></span></code></pre>

























<table><thead><tr><th>标志位</th><th>说明</th></tr></thead><tbody><tr><td>ZF (Zero Flag)</td><td>结果为 0 时置 1</td></tr><tr><td>SF (Sign Flag)</td><td>结果为负时置 1</td></tr><tr><td>CF (Carry Flag)</td><td>无符号溢出（加法有进位，减法有借位）</td></tr><tr><td>OF (Overflow Flag)</td><td>有符号溢出（正+正=负，负+负=正）</td></tr></tbody></table>
<h3 id="mov">mov</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="plaintext"><code><span class="line"><span>mov 源操作数, 目标操作数</span></span>
<span class="line"><span>目标 = 源</span></span></code></pre>
<h3 id="sar">sar</h3>
<p>Shift Arithmetic Right</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">sar</span><span style="color:#E1E4E8"> $n</span><span style="color:#9ECBFF">,</span><span style="color:#9ECBFF"> %reg</span><span style="color:#6A737D">        # 将寄存器右移 n 位</span></span>
<span class="line"><span style="color:#B392F0">sar</span><span style="color:#9ECBFF"> %reg</span><span style="color:#6A737D">            # /2</span></span></code></pre>
<blockquote>
<p>⚠️ 注意：AT&#x26;T 语法是 shr $移动位数, 源操作数</p>
</blockquote>
<h2 id="gdb-ref">gdb ref</h2>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#F97583">break</span><span style="color:#9ECBFF"> main</span><span style="color:#6A737D">          # 在 main 函数设断点</span></span>
<span class="line"><span style="color:#F97583">break</span><span style="color:#9ECBFF"> phase_1</span><span style="color:#6A737D">       # 在 phase_1 设断点</span></span>
<span class="line"><span style="color:#F97583">break</span><span style="color:#79B8FF"> *</span><span style="color:#9ECBFF">0x401234</span><span style="color:#6A737D">     # 在指定地址设断点</span></span>
<span class="line"><span style="color:#F97583">break</span><span style="color:#9ECBFF"> file.c:10</span><span style="color:#6A737D">     # 在文件某行设断点</span></span>
<span class="line"><span style="color:#B392F0">delete</span><span style="color:#6A737D">              # 删除所有断点</span></span>
<span class="line"><span style="color:#B392F0">delete</span><span style="color:#79B8FF"> 1</span><span style="color:#6A737D">            # 删除编号为 1 的断点</span></span>
<span class="line"><span style="color:#B392F0">disable</span><span style="color:#79B8FF"> 1</span><span style="color:#6A737D">           # 禁用断点</span></span>
<span class="line"><span style="color:#B392F0">enable</span><span style="color:#79B8FF"> 1</span><span style="color:#6A737D">            # 启用断点</span></span></code></pre>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">run</span><span style="color:#6A737D">                 # 开始运行程序</span></span>
<span class="line"><span style="color:#B392F0">run</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF"> input.txt</span><span style="color:#6A737D">     # 带输入文件运行</span></span>
<span class="line"><span style="color:#F97583">continue</span><span style="color:#E1E4E8"> (或 </span><span style="color:#9ECBFF">c</span><span style="color:#E1E4E8">)     </span><span style="color:#6A737D"># 继续执行（跳出断点）</span></span>
<span class="line"><span style="color:#B392F0">stepi</span><span style="color:#E1E4E8"> (或 </span><span style="color:#9ECBFF">si</span><span style="color:#E1E4E8">)       </span><span style="color:#6A737D"># 单步执行一条汇编指令</span></span>
<span class="line"><span style="color:#B392F0">nexti</span><span style="color:#E1E4E8"> (或 </span><span style="color:#9ECBFF">ni</span><span style="color:#E1E4E8">)       </span><span style="color:#6A737D"># 单步跳过函数调用（汇编级）</span></span>
<span class="line"><span style="color:#B392F0">step</span><span style="color:#6A737D">                # 单步进入函数（源码级）</span></span>
<span class="line"><span style="color:#B392F0">next</span><span style="color:#6A737D">                # 单步跳过函数（源码级）</span></span>
<span class="line"><span style="color:#B392F0">finish</span><span style="color:#6A737D">              # 运行到当前函数返回</span></span></code></pre>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">disassemble</span><span style="color:#6A737D">         # 反汇编当前函数</span></span>
<span class="line"><span style="color:#B392F0">disas</span><span style="color:#9ECBFF"> phase_1</span><span style="color:#6A737D">       # 反汇编 phase_1 函数</span></span>
<span class="line"><span style="color:#B392F0">info</span><span style="color:#9ECBFF"> registers</span><span style="color:#6A737D">      # 查看所有寄存器值</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8"> $rax          </span><span style="color:#6A737D"># 打印寄存器 rax 的值</span></span>
<span class="line"><span style="color:#B392F0">x/s</span><span style="color:#E1E4E8"> $rdi            </span><span style="color:#6A737D"># 以字符串格式查看 $rdi 指向的内容</span></span>
<span class="line"><span style="color:#B392F0">x/d</span><span style="color:#E1E4E8"> $rsp            </span><span style="color:#6A737D"># 以十进制查看栈顶内容</span></span>
<span class="line"><span style="color:#B392F0">x/10gx</span><span style="color:#E1E4E8"> $rsp         </span><span style="color:#6A737D"># 查看栈顶 10 个 8 字节十六进制值</span></span>
<span class="line"><span style="color:#B392F0">info</span><span style="color:#9ECBFF"> frame</span><span style="color:#6A737D">          # 查看当前栈帧信息</span></span>
<span class="line"><span style="color:#B392F0">backtrace</span><span style="color:#E1E4E8"> (或 </span><span style="color:#9ECBFF">bt</span><span style="color:#E1E4E8">)   </span><span style="color:#6A737D"># 查看调用栈</span></span></code></pre>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#79B8FF">print</span><span style="color:#9ECBFF"> variable</span><span style="color:#6A737D">      # 打印变量值（如果有符号信息）</span></span>
<span class="line"><span style="color:#79B8FF">print</span><span style="color:#E1E4E8"> &#x26;</span><span style="color:#B392F0">variable</span><span style="color:#6A737D">     # 打印变量地址</span></span>
<span class="line"><span style="color:#B392F0">x/20c</span><span style="color:#9ECBFF"> array</span><span style="color:#6A737D">         # 以字符形式查看数组前 20 项</span></span>
<span class="line"><span style="color:#B392F0">x/6dw</span><span style="color:#9ECBFF"> input_array</span><span style="color:#6A737D">   # 查看 6 个整数（如 read_six_numbers 的输入）</span></span>
<span class="line"><span style="color:#B392F0">x/d</span><span style="color:#E1E4E8"> $rsp </span><span style="color:#9ECBFF">+</span><span style="color:#79B8FF"> 0x8</span><span style="color:#6A737D">      # 查看rsp寄存器地址偏移一个字节的位置内容</span></span>
<span class="line"><span style="color:#B392F0">x/d</span><span style="color:#79B8FF"> 0x8</span><span style="color:#E1E4E8">($rsp)       </span><span style="color:#6A737D"># 上一个的等价写法(部分版本不能这么用)</span></span>
<span class="line"><span style="color:#B392F0">p/x</span><span style="color:#E1E4E8"> $rsp </span><span style="color:#9ECBFF">+</span><span style="color:#79B8FF"> 0x8</span><span style="color:#6A737D">    	# 以十六进制显示的地址值</span></span></code></pre>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#F97583">break</span><span style="color:#9ECBFF"> phase_2</span><span style="color:#9ECBFF"> if</span><span style="color:#E1E4E8"> $rdi </span><span style="color:#9ECBFF">==</span><span style="color:#79B8FF"> 0x402450</span></span>
<span class="line"><span style="color:#F97583">break</span><span style="color:#79B8FF"> *</span><span style="color:#9ECBFF">0x401234</span><span style="color:#9ECBFF"> if</span><span style="color:#E1E4E8"> $rax </span><span style="color:#F97583">></span><span style="color:#79B8FF"> 100</span></span>
<span class="line"><span style="color:#B392F0">delete</span><span style="color:#6A737D">														# 删除所有断点</span></span></code></pre>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">run</span></span>
<span class="line"><span style="color:#B392F0">r</span></span>
<span class="line"><span style="color:#B392F0">启动程序（可带参数，如</span></span>
<span class="line"><span style="color:#B392F0">run</span><span style="color:#F97583"> &#x3C;</span><span style="color:#9ECBFF"> input.txt</span></span>
<span class="line"><span style="color:#B392F0">）</span></span>
<span class="line"><span style="color:#F97583">continue</span></span>
<span class="line"><span style="color:#B392F0">c</span></span>
<span class="line"><span style="color:#B392F0">继续执行，直到下一个断点或程序结束</span></span>
<span class="line"><span style="color:#B392F0">step</span></span>
<span class="line"><span style="color:#B392F0">s</span></span>
<span class="line"><span style="color:#B392F0">单步执行（进入函数内部）</span></span>
<span class="line"><span style="color:#B392F0">next</span></span>
<span class="line"><span style="color:#B392F0">n</span></span>
<span class="line"><span style="color:#B392F0">单步执行（跳过函数调用）</span></span>
<span class="line"><span style="color:#B392F0">stepi</span></span>
<span class="line"><span style="color:#B392F0">si</span></span>
<span class="line"><span style="color:#B392F0">单步执行一条汇编指令</span></span>
<span class="line"><span style="color:#B392F0">（关键！用于汇编级调试）</span></span>
<span class="line"><span style="color:#B392F0">nexti</span></span>
<span class="line"><span style="color:#B392F0">ni</span></span>
<span class="line"><span style="color:#B392F0">单步执行一条汇编指令，但不进入函数</span></span>
<span class="line"><span style="color:#B392F0">finish</span></span>
<span class="line"><span style="color:#B392F0">fin</span></span>
<span class="line"><span style="color:#B392F0">运行到当前函数返回（跳出函数）</span></span>
<span class="line"><span style="color:#79B8FF">kill</span></span>
<span class="line"><span style="color:#B392F0">-</span></span>
<span class="line"><span style="color:#B392F0">终止当前运行的程序</span></span>
<span class="line"><span style="color:#B392F0">quit</span></span>
<span class="line"><span style="color:#B392F0">q</span></span>
<span class="line"><span style="color:#B392F0">退出</span><span style="color:#9ECBFF"> CGDB</span></span></code></pre>
<p>特殊操作</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#6A737D"># 回溯操作，需程序支持</span></span>
<span class="line"><span style="color:#B392F0">record</span><span style="color:#6A737D">	#在run前调用</span></span>
<span class="line"><span style="color:#B392F0">reverse——stepi</span></span>
<span class="line"><span style="color:#B392F0">reverse-nexti</span></span>
<span class="line"><span style="color:#B392F0">reverse-continue</span><span style="color:#6A737D">	# 反向continue</span></span></code></pre>

















<table><thead><tr><th>操作</th><th>快捷键</th></tr></thead><tbody><tr><td>进入命令行窗口（输入 GDB 命令）</td><td>按 i 或 Insert 键</td></tr><tr><td>返回源码/汇编窗口</td><td>按 Esc 键</td></tr></tbody></table>
<h2 id="references">references</h2>
<ol>
<li>[zhihu CSAPPLab]<a href="https://zhuanlan.zhihu.com/p/449879729">https://zhuanlan.zhihu.com/p/449879729</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/451623574">(99+ 封私信 / 80 条消息) 手把手教你拆解 CSAPP 的 炸弹实验室 BombLab - 知乎</a></li>
</ol> </article>  </div> </article> </main> <footer class="border-t border-gray-200 bg-white text-center py-4 mt-8"> <p class="text-sm text-gray-500">
© 2025 我的博客
</p> </footer> </body></html>